#include <ros/ros.h>
#include <mavros_msgs/CommandBool.h>
#include <mavros_msgs/SetMode.h>
#include <mavros_msgs/State.h>
#include <cmath>
#include <algorithm>
#include "std_msgs/String.h"
#include <mavros_msgs/MPC_Inputs.h>
#include <mavros_msgs/MPC_Outputs.h>
#include <geometry_msgs/PoseStamped.h>
#include <iostream>

#include <sstream>
#include <Eigen/Dense>
#include <unsupported/Eigen/MatrixFunctions>
#include <Eigen/Core>
#include <Eigen/Cholesky>

mavros_msgs::State current_state;
void state_cb(const mavros_msgs::State::ConstPtr& msg){
    current_state = *msg;
}

//Callback function for MPC inputs topic
mavros_msgs::MPC_Inputs mpc_ins;
void mpc_inputs_cb(const mavros_msgs::MPC_Inputs::ConstPtr& msg){
    mpc_ins = *msg;
}


Eigen::Matrix<double, 10, 1> QPhild(const Eigen::Matrix<double, 10, 10> &E, Eigen::Matrix<double, 10, 1> &F, const Eigen::Matrix<double, 40, 10> &CC, Eigen::Matrix<double, 40, 1> &d)
{
    // Compute decomposition of E
    // static Eigen::LLT<Eigen::Matrix<double, 8, 8>> lltOfE(E);
    static Eigen::Matrix<double, 10, 40> CC_transd = CC.transpose();
    // Eigen::Matrix<double, 8, 1> DeltU=-lltOfE.solve(F);
    Eigen::Matrix<double, 10, 1> DeltU=-E.colPivHouseholderQr().solve(F);

    int kk=0;
    for(int i=0;i<40;i++){
        if(CC.row(i)*DeltU>d(i)){
            kk++;
        }else{
            kk+=0;
        }
    }

    if(kk==0){
        return DeltU;
    }else{

    // std::cout<<"Limiting MPC output\n";

    // Eigen::Matrix<double, 32, 32> T = CC*(lltOfE.solve(CC_transd));
    // Eigen::Matrix<double, 32, 1> K = (CC*(lltOfE.solve(F)) + d);

    Eigen::Matrix<double, 40, 40> T = CC*(E.colPivHouseholderQr().solve(CC_transd));
    Eigen::Matrix<double, 40, 1> K = (CC*(E.colPivHouseholderQr().solve(F)) + d);

    int k_row = 40;
    Eigen::Matrix<double, 40, 1> lambda;
    lambda.setZero(40, 1);
    double al = 3.0;
    int km = 0;

    do
    {
        Eigen::Matrix<double, 40, 1> lambda_p = lambda;
        // loop to determine lambda values for respective iterations
        int i = 0;
        do
        {
            // float Tii = T(i, i);
            // // T(i, i) = 0;
            // float la = -(T.col(i).dot(lambda) + K(i)) / Tii;
            // T(i, i) = Tii;

            double w= T.row(i)*lambda-T(i,i)*lambda(i);
            w = w + K(i);
            double la = -w/T(i,i);
            if (la < 0.0f) lambda(i) = 0.0f;
            else lambda(i) = la;
            i++;
        } while (i < k_row);
        // al = (lambda - lambda_p).squaredNorm();
        al = (lambda - lambda_p).transpose()*(lambda - lambda_p);

        if (al < 0.001f) break;
        km++;
    } while (km < 15);

    // DeltU = -lltOfE.solve(F) - (lltOfE.solve(CC_transd))*lambda;
    DeltU = -E.colPivHouseholderQr().solve(F) - (E.colPivHouseholderQr().solve(CC_transd))*lambda;

    return DeltU;
    }
}

//MPC inputs and outputs declaration !!!ADD Assign in callback function of own topic and find way to convert double array to float array!!!
float MPC_ref[2]={0,0};
float MPC_mo[2]={0,0};
float MPC_mv[2]={0,0};


int main(int argc, char **argv)
{
    ros::init(argc, argv, "MPC_handler");
    ros::NodeHandle nh;

    ros::Subscriber state_sub = nh.subscribe<mavros_msgs::State>
            ("mavros/state", 10, state_cb);

    //!!!Make New Subscriber(PX4->ROS) and Publisher(ROS->PX4) to your own topics!!!
    ros::Subscriber mpc_in_sub = nh.subscribe<mavros_msgs::MPC_Inputs>
            ("/mavros/mpc_inputs_topic", 1, mpc_inputs_cb);

    ros::Publisher mpc_outputs_pub = nh.advertise<mavros_msgs::MPC_Outputs>
            ("/mavros/mpc_outputs/mpc_outputs_topic", 1);        

    // Required for now to allow vehicle to go into offbaord mode(CHECK if you can make mpc outputs publish do the same)
    ros::Publisher local_pos_pub = nh.advertise<geometry_msgs::PoseStamped>
            ("mavros/setpoint_position/local", 10);

    ros::ServiceClient arming_client = nh.serviceClient<mavros_msgs::CommandBool>
            ("mavros/cmd/arming");
    ros::ServiceClient set_mode_client = nh.serviceClient<mavros_msgs::SetMode>
            ("mavros/set_mode");

    //the setpoint publishing rate MUST be faster than 2Hz
    // ros::Rate rate(1/0.12);//50Hz corresponding to 0.02 seconds therefore 8.33Hz corresponds to 0.12 seconds
    // ros::Rate rate(25.0);//50Hz corresponding to 0.02 seconds therefore 25Hz corresponds to 0.04 seconds
    ros::Rate rate(12.5);//12.5Hz corresponds to 0.08 seconds

     // wait for FCU connection
    while(ros::ok() && !current_state.connected){
        ros::spinOnce();
        rate.sleep();
    }

    // Required for now to allow vehicle to go into offbaord mode(CHECK if you can make mpc outputs publish do the same)
    geometry_msgs::PoseStamped pose;
    pose.pose.position.x = 0;
    pose.pose.position.y = 0;
    pose.pose.position.z = 2;

    //!!!Define Struct for publish topic!!!
    mavros_msgs::MPC_Outputs mpc_outs;

    //Intialise MPC Matrices

    /*
    //Updated Model Spec pre aero coeff tune
    Eigen::Matrix<double, 9, 9> A_MPC_SCR;
    A_MPC_SCR <<0.988303788868735, 0.956829275721058, -0.0475784038628204, -0.851406873089384, 0.0161014415422266, -0.00928284258039210, -0.0236049423011128, 0.00551189040500842, 0.0,
                -0.00504487142083283, 0.427517456151319, 0.0204940641345111, -0.217871888899683, -4.98230457154761e-05,	-0.00876842476811453, 0.0208863816156044, -0.00376676910398808, 0.0,
                0.00983162632736217, -1.63539957988862,	-0.128313290819311,	-4.20028146895285, 7.18111642734196e-05, -0.0231221031910466, 0.274023467609398, -0.0716224753004491, 0.0,
                0.000480991257420739, -0.162225954648086, 0.0383726060928523, 0.684582929379962, 2.48014255189741e-06, 0.000122514504830343, 0.0254392109383727, -0.00543246812644712, 0.0,
                0.0, 0.0, 0.0, 0.0,	0.618783391806141, 0.0,	0.0, 0.0, 0.0,
                0.00622564366654418, -0.808096580145375, -0.198110135955530, -2.68432108496922,	4.85749611072077e-05, 0.216211527948784, -0.103137113298239, -0.0455520229623938, 0.0,
                0.00785290198758295, -1.39140353669246,	-0.396821142465637,	-5.76926463890825, 5.60239585336837e-05, -0.209424555146209, 0.912216058898158,	-0.0985725645870690, 0.0,
                0.00650691592136939, -1.64304326153812,	0.0210399167107554,	2.10335738049081, 4.10551906629788e-05,	0.0136992291868433,	0.00172974372062621, 0.999015722572996,	0.0,
                0.00650691592136939, -1.64304326153812,	0.0210399167107554,	2.10335738049081, 4.10551906629788e-05,	0.0136992291868433,	0.00172974372062621, -0.000984277427004409, 1.0;
    Eigen::Matrix<double, 9, 2> B_MPC_SCR;
    B_MPC_SCR <<-0.0177671461896709, 0.00418188720359372,
                0.0121712440683987,	-8.86304176405474e-06,
                0.233322162264240, 9.92057020758965e-06,
                0.0175258775827737,	2.60333938829440e-07,
                0.0, 0.381216608193859,
                0.149099858368945, 6.97257611492242e-06,
                0.320498527706422, 7.61840137661589e-06,
                -0.116845857371769,	5.18816423479338e-06,
                0.00315414262823086, 5.18816423479338e-06;
    Eigen::Matrix<double, 2, 9> C_MPC_SCR;
    C_MPC_SCR <<0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	1.0,
                1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0;            

    Eigen::Matrix<double, 40, 10> CC; 
    CC <<1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 1.0, 0.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 1.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	1.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 1.0,
        -1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, -1.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	-1.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, -1.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, -1.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, -1.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	-1.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, -1.0,
        1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 0.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 1.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 1.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 1.0, 0.0,	1.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 1.0,	0.0, 1.0,
        -1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, 0.0, 0.0, 0.0,	0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0, 0.0,	0.0, 0.0,
        0.0, -1.0, 0.0, -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0, 0.0,	-1.0, 0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0;

    Eigen::Matrix<double, 10, 10> E;
    E <<233.623846811616, -6.67475275291013, 222.245088639912, -6.65638268071209, 210.915493540514,	-6.60538135256243, 199.511905960100, -6.52216278385728,	188.066532689884, -6.40749631129746,
        -6.67475275291013, 4.54998041111870, -6.36143984715080,	4.31163073277686, -6.04186246849384, 4.08702993879443, -5.71762730905593, 3.86171626058937,	-5.39054393087445, 3.63630781935304,
        222.245088639912, -6.36143984715080, 211.935796426652, -6.35441130778917, 201.211171706567,	-6.31590355901887, 190.540227973826, -6.24589059633905,	179.800162836538, -6.14487838460659,
        -6.65638268071209, 4.31163073277686, -6.35441130778917,	4.11874597406376, -6.04527498145573, 3.89428592824099, -5.73016749735545, 3.68366093685824,	-5.41070431300974, 3.47241151508500,
        210.915493540514, -6.04186246849384, 201.211171706567, -6.04527498145573, 191.536213075412,	-6.01889859770116, 181.450306501686, -5.96213597834343,	171.422808034929, -5.87505030695842,
        -6.60538135256243, 4.08702993879443, -6.31590355901887,	3.89428592824099, -6.01889859770116, 3.71480018896413, -5.71501865603800, 3.50382406511279,	-5.40546650493829, 3.30677023657506,
        199.511905960100, -5.71762730905593, 190.540227973826, -5.73016749735545, 181.450306501686,	-5.71501865603800, 172.393998384291, -5.67114055206045,	162.931324350136, -5.59802225358280,
        -6.52216278385728, 3.86171626058937, -6.24589059633905,	3.68366093685824, -5.96213597834343, 3.50382406511279, -5.67114055206045, 3.33732902983205,	-5.37356567112981, 3.13942956316529,
        188.066532689884, -5.39054393087445, 179.800162836538, -5.41070431300974, 171.422808034929,	-5.40546650493829, 162.931324350136, -5.37356567112981,	154.477889733878, -5.31404518340676,
        -6.40749631129746, 3.63630781935304, -6.14487838460659, 3.47241151508500, -5.87505030695842, 3.30677023657506, -5.59802225358280, 3.13942956316529,	-5.31404518340676, 2.98551531168022;                 
    
    Eigen::Matrix<double, 60, 10> H;
    H <<0.00315414262823086,5.18816423479338e-06,0,0,0,0,0,0,0,0,
        -0.0177671461896709,0.00418188720359372,0,0,0,0,0,0,0,0,
        0.0306790003901851,6.86606919662152e-05,0.00315414262823086,5.18816423479338e-06,0,0,0,0,0,0,
        -0.0592968914651803,0.0144436090697952,-0.0177671461896709,0.00418188720359372,0,0,0,0,0,0,
        0.0946957036031508,0.000293544947567428,0.0306790003901851,6.86606919662152e-05,0.00315414262823086,5.18816423479338e-06,0,0,0,0,
        -0.112011231322049,0.0283317764259239,-0.0592968914651803,0.0144436090697952,-0.0177671461896709,0.00418188720359372,0,0,0,0,
        0.190349772921294,0.000795764941184245,0.0946957036031508,0.000293544947567428,0.0306790003901851,6.86606919662152e-05,0.00315414262823086,5.18816423479338e-06,0,0,
        -0.170623490404455,0.0443019977026886,-0.112011231322049,0.0283317764259239,-0.0592968914651803,0.0144436090697952,-0.0177671461896709,0.00418188720359372,0,0,
        0.305967238082344,0.00168418025692675,0.190349772921294,0.000795764941184245,0.0946957036031508,0.000293544947567428,0.0306790003901851,6.86606919662152e-05,0.00315414262823086,5.18816423479338e-06,
        -0.232902102624938,0.0613863380529822,-0.170623490404455,0.0443019977026886,-0.112011231322049,0.0283317764259239,-0.0592968914651803,0.0144436090697952,-0.0177671461896709,0.00418188720359372,
        0.430925853913365,0.00304839437568308,0.305967238082344,0.00168418025692675,0.190349772921294,0.000795764941184245,0.0946957036031508,0.000293544947567428,0.0306790003901851,6.86606919662152e-05,
        -0.297227412056897,0.0789824840754984,-0.232902102624938,0.0613863380529822,-0.170623490404455,0.0443019977026886,-0.112011231322049,0.0283317764259239,-0.0592968914651803,0.0144436090697952,
        0.558351517961308,0.00495197856658689,0.430925853913365,0.00304839437568308,0.305967238082344,0.00168418025692675,0.190349772921294,0.000795764941184245,0.0946957036031508,0.000293544947567428,
        -0.362078829592129,0.0967197006724318,-0.297227412056897,0.0789824840754984,-0.232902102624938,0.0613863380529822,-0.170623490404455,0.0443019977026886,-0.112011231322049,0.0283317764259239,
        0.684668963631172,0.00743128187018139,0.558351517961308,0.00495197856658689,0.430925853913365,0.00304839437568308,0.305967238082344,0.00168418025692675,0.190349772921294,0.000795764941184245,
        -0.426223373957693,0.114373814818009,-0.362078829592129,0.0967197006724318,-0.297227412056897,0.0789824840754984,-0.232902102624938,0.0613863380529822,-0.170623490404455,0.0443019977026886,
        0.808319039853504,0.0104985676703537,0.684668963631172,0.00743128187018139,0.558351517961308,0.00495197856658689,0.430925853913365,0.00304839437568308,0.305967238082344,0.00168418025692675,
        -0.488873506587470,0.131813357601568,-0.426223373957693,0.114373814818009,-0.362078829592129,0.0967197006724318,-0.297227412056897,0.0789824840754984,-0.232902102624938,0.0613863380529822,
        0.928755807844449,0.0141473316053637,0.808319039853504,0.0104985676703537,0.684668963631172,0.00743128187018139,0.558351517961308,0.00495197856658689,0.430925853913365,0.00304839437568308,
        -0.549657909381828,0.148965349337862,-0.488873506587470,0.131813357601568,-0.426223373957693,0.114373814818009,-0.362078829592129,0.0967197006724318,-0.297227412056897,0.0789824840754984,
        1.04590537802859,0.0183579440490898,0.928755807844449,0.0141473316053637,0.808319039853504,0.0104985676703537,0.684668963631172,0.00743128187018139,0.558351517961308,0.00495197856658689,
        -0.608491971736842,0.165793448622356,-0.549657909381828,0.148965349337862,-0.488873506587470,0.131813357601568,-0.426223373957693,0.114373814818009,-0.362078829592129,0.0967197006724318,
        1.15992261734790,0.0231025474442787,1.04590537802859,0.0183579440490898,0.928755807844449,0.0141473316053637,0.808319039853504,0.0104985676703537,0.684668963631172,0.00743128187018139,
        -0.665446846709969,0.182283941557550,-0.608491971736842,0.165793448622356,-0.549657909381828,0.148965349337862,-0.488873506587470,0.131813357601568,-0.426223373957693,0.114373814818009,
        1.27107746700115,0.0283488327829066,1.15992261734790,0.0231025474442787,1.04590537802859,0.0183579440490898,0.928755807844449,0.0141473316053637,0.808319039853504,0.0104985676703537,
        -0.720659484752055,0.198436763038742,-0.665446846709969,0.182283941557550,-0.608491971736842,0.165793448622356,-0.549657909381828,0.148965349337862,-0.488873506587470,0.131813357601568,
        1.37968677753159,0.0340627235302914,1.27107746700115,0.0283488327829066,1.15992261734790,0.0231025474442787,1.04590537802859,0.0183579440490898,0.928755807844449,0.0141473316053637,
        -0.774283616214403,0.214259779978585,-0.720659484752055,0.198436763038742,-0.665446846709969,0.182283941557550,-0.608491971736842,0.165793448622356,-0.549657909381828,0.148965349337862,
        1.48606730285116,0.0402101573812047,1.37968677753159,0.0340627235302914,1.27107746700115,0.0283488327829066,1.15992261734790,0.0231025474442787,1.04590537802859,0.0183579440490898,
        -0.826467241324902,0.229765195742027,-0.774283616214403,0.214259779978585,-0.720659484752055,0.198436763038742,-0.665446846709969,0.182283941557550,-0.608491971736842,0.165793448622356,
        1.59050674446230,0.0467581849338512,1.48606730285116,0.0402101573812047,1.37968677753159,0.0340627235302914,1.27107746700115,0.0283488327829066,1.15992261734790,0.0231025474442787,
        -0.877343774316950,0.244967328186042,-0.826467241324902,0.229765195742027,-0.774283616214403,0.214259779978585,-0.720659484752055,0.198436763038742,-0.665446846709969,0.182283941557550,
        1.69325102545015,0.0536755800134343,1.59050674446230,0.0467581849338512,1.48606730285116,0.0402101573812047,1.37968677753159,0.0340627235302914,1.27107746700115,0.0283488327829066,
        -0.927029470724786,0.259881268522935,-0.877343774316950,0.244967328186042,-0.826467241324902,0.229765195742027,-0.774283616214403,0.214259779978585,-0.720659484752055,0.198436763038742,
        1.79450321370940,0.0609331185513411,1.69325102545015,0.0536755800134343,1.59050674446230,0.0467581849338512,1.48606730285116,0.0402101573812047,1.37968677753159,0.0340627235302914,
        -0.975623773799816,0.274522097505885,-0.927029470724786,0.259881268522935,-0.877343774316950,0.244967328186042,-0.826467241324902,0.229765195742027,-0.774283616214403,0.214259779978585,
        1.89442872808122,0.0685036457930236,1.79450321370940,0.0609331185513411,1.69325102545015,0.0536755800134343,1.59050674446230,0.0467581849338512,1.48606730285116,0.0402101573812047,
        -1.02321109887090,0.288904448587579,-0.975623773799816,0.274522097505885,-0.927029470724786,0.259881268522935,-0.877343774316950,0.244967328186042,-0.826467241324902,0.229765195742027,
        1.99316269110888,0.0763620189739961,1.89442872808122,0.0685036457930236,1.79450321370940,0.0609331185513411,1.69325102545015,0.0536755800134343,1.59050674446230,0.0467581849338512,
        -1.06986324694923,0.303042282875524,-1.02321109887090,0.288904448587579,-0.975623773799816,0.274522097505885,-0.927029470724786,0.259881268522935,-0.877343774316950,0.244967328186042,
        2.09081707180099,0.0844849854414484,1.99316269110888,0.0763620189739961,1.89442872808122,0.0685036457930236,1.79450321370940,0.0609331185513411,1.69325102545015,0.0536755800134343,
        -1.11564190446347,0.316948790135040,-1.06986324694923,0.303042282875524,-1.02321109887090,0.288904448587579,-0.975623773799816,0.274522097505885,-0.927029470724786,0.259881268522935,
        2.18748664352975,0.0928510348203598,2.09081707180099,0.0844849854414484,1.99316269110888,0.0763620189739961,1.89442872808122,0.0685036457930236,1.79450321370940,0.0609331185513411,
        -1.16060088431640,0.330636362266445,-1.11564190446347,0.316948790135040,-1.06986324694923,0.303042282875524,-1.02321109887090,0.288904448587579,-0.975623773799816,0.274522097505885,
        2.28325356014833,0.101440248059334,2.18748664352975,0.0928510348203598,2.09081707180099,0.0844849854414484,1.99316269110888,0.0763620189739961,1.89442872808122,0.0685036457930236,
        -1.20478794645659,0.344116606430022,-1.16060088431640,0.330636362266445,-1.11564190446347,0.316948790135040,-1.06986324694923,0.303042282875524,-1.02321109887090,0.288904448587579,
        2.37819068824513,0.110234155367011,2.28325356014833,0.101440248059334,2.18748664352975,0.0928510348203598,2.09081707180099,0.0844849854414484,1.99316269110888,0.0763620189739961,
        -1.24824617477735,0.357400378218428,-1.20478794645659,0.344116606430022,-1.16060088431640,0.330636362266445,-1.11564190446347,0.316948790135040,-1.06986324694923,0.303042282875524,
        2.47236393464500,0.119215608161669,2.37819068824513,0.110234155367011,2.28325356014833,0.101440248059334,2.18748664352975,0.0928510348203598,2.09081707180099,0.0844849854414484,
        -1.29101496592735,0.370497823572698,-1.24824617477735,0.357400378218428,-1.20478794645659,0.344116606430022,-1.16060088431640,0.330636362266445,-1.11564190446347,0.316948790135040,
        2.56583381246990,0.128368666136677,2.47236393464500,0.119215608161669,2.37819068824513,0.110234155367011,2.28325356014833,0.101440248059334,2.18748664352975,0.0928510348203598,
        -1.33313071453450,0.383418423224550,-1.29101496592735,0.370497823572698,-1.24824617477735,0.357400378218428,-1.20478794645659,0.344116606430022,-1.16060088431640,0.330636362266445,
        2.65865645974094,0.137678498455071,2.56583381246990,0.128368666136677,2.47236393464500,0.119215608161669,2.37819068824513,0.110234155367011,2.28325356014833,0.101440248059334,
        -1.37462727831376,0.396171036471715,-1.33313071453450,0.383418423224550,-1.29101496592735,0.370497823572698,-1.24824617477735,0.357400378218428,-1.20478794645659,0.344116606430022,
        2.75088428511070,0.147131297202353,2.65865645974094,0.137678498455071,2.56583381246990,0.128368666136677,2.47236393464500,0.119215608161669,2.37819068824513,0.110234155367011,
        -1.41553629253776,0.408763942819803,-1.37462727831376,0.396171036471715,-1.33313071453450,0.383418423224550,-1.29101496592735,0.370497823572698,-1.24824617477735,0.357400378218428,
        2.84256637450782,0.156714201035590,2.75088428511070,0.147131297202353,2.65865645974094,0.137678498455071,2.56583381246990,0.128368666136677,2.47236393464500,0.119215608161669,
        -1.45588738648895,0.421204880958889,-1.41553629253776,0.408763942819803,-1.37462727831376,0.396171036471715,-1.33313071453450,0.383418423224550,-1.29101496592735,0.370497823572698,
        2.93374875480133,0.166415227131519,2.84256637450782,0.156714201035590,2.75088428511070,0.147131297202353,2.65865645974094,0.137678498455071,2.56583381246990,0.128368666136677,
        -1.49570833927717,0.433501085011604,-1.45588738648895,0.421204880958889,-1.41553629253776,0.408763942819803,-1.37462727831376,0.396171036471715,-1.33313071453450,0.383418423224550;

    Eigen::Matrix<double, 60, 11> P; 
    P <<0.00650691592136939,-1.64304326153812,0.0210399167107554,2.10335738049081,4.10551906629788e-05,0.0136992291868433,0.00172974372062621,-0.000984277427004409,1,1,0,
        0.988303788868735,0.956829275721058,-0.0475784038628204,-0.851406873089384,0.0161014415422266,-0.00928284258039210,-0.0236049423011128,0.00551189040500842,0,0,1,
        0.0290446020221750,-4.36977788230629,0.0826881499013423,5.86187388555322,0.000301596261290290,0.0441023582126371,0.0284251450106134,-0.0104549191975390,2,1,0,
        1.95913650138184,2.55874764577012,-0.0902348240281464,-2.11164287214267,0.0419231143510738,-0.0228392879092807,-0.0822116807600288,0.0236441985123573,0,0,1,
        0.0743328307898818,-7.91368356361804,0.166271941775914,10.5986529160008,0.00101894568023283,0.0813896709205600,0.106377925925271,-0.0393550900509424,3,1,0,
        2.90908048766470,4.50942852672505,-0.120157266632031,-3.55815021822246,0.0734437441174224,-0.0354747378877763,-0.167450593208566,0.0573716166049378,0,0,1,
        0.147233179282549,-12.0247079559926,0.244637367659740,15.7166028946912,0.00243240080803159,0.115731468361629,0.243637201460477,-0.0967137915942383,4,1,0,
        3.83655427547155,6.60930583740627,-0.140006080298887,-5.05988487852818,0.108136724204855,-0.0453014342446647,-0.270523539039569,0.107933073199187,0,0,1,
        0.250677979259551,-16.4384475284195,0.301813294450900,20.8233580658888,0.00475202685774111,0.141510092617557,0.431021272860906,-0.187623378351284,5,1,0,
        4.74112745553979,8.73883751710030,-0.152265287334345,-6.52435605815762,0.144423880830245,-0.0518946678196030,-0.385123491943037,0.175834681540192,0,0,1,
        0.385745424741259,-20.9236063043305,0.334721385912635,25.7146322874838,0.00813873370470821,0.157339645979115,0.651820302654736,-0.313714611092515,6,1,0,
        5.62305325815846,10.8256129907701,-0.158072718290085,-7.88786365955375,0.181328137770393,-0.0553555661425877,-0.506354437943480,0.261064384100653,0,0,1,
        0.552055255556831,-25.3150452677380,0.347477603772407,30.3088873556081,0.0126961281753246,0.164405631016078,0.889696496143577,-0.474441423124012,7,1,0,
        6.48300444616404,12.8237339708891,-0.158257132053716,-9.11446015082545,0.218252926737121,-0.0560648156749755,-0.629949429767144,0.363141724316375,0,0,1,
        0.748282436097093,-29.5151548262456,0.346087255294347,34.5895833819071,0.0184732280297002,0.164843744682889,1.13213666494347,-0.668177807119376,8,1,0,
        7.32191461858671,14.7049055835885,-0.153933344605467,-10.1912341281791,0.254842450900663,-0.0545851333652254,-0.752264809966889,0.481224126016553,0,0,1,
        0.972601698740585,-33.4775974410903,0.335785167001548,38.5699142919056,0.0254740261390233,0.160774129258013,1.37080344261680,-0.892878423243901,9,1,0,
        8.14086407614133,16.4544224969159,-0.146439290250047,-11.1205772889990,0.290893085290825,-0.0515460053442213,-0.870510241046146,0.614257741838062,0,0,1,
        1.22299420626061,-37.1884841257422,0.320373869573898,42.2750944866377,0.0336694236156307,0.153920465477005,1.60065723939496,-1.14640589632050,10,1,0,
        8.94099150216508,18.0679653576420,-0.137052571086425,-11.9128482150092,0.326296937693344,-0.0475327786827527,-0.982837341737110,0.761113550415242,0,0,1,
        1.49742924233101,-40.6520104632902,0.302416992239167,45.7340499259946,0.0430084411096823,0.145552249860982,1.81894794453512,-1.42667947410322,11,1,0,
        9.72343003354997,19.5483031168397,-0.126790705493019,-12.5812676198080,0.361005707175833,-0.0430189998358420,-1.08823227219202,0.920678429707870,0,0,1,
        1.79395997263096,-43.8814164151345,0.283589766264487,48.9752928754214,0.0534272938797238,0.136548314438082,2.02443818237363,-1.73174333716873,12,1,0,
        10.4892669923313,20.9023134785812,-0.116359530086294,-13.1390996048961,0.395007495342322,-0.0383475175139273,-1.18630733932064,1.09190250151891,0,0,1,
        2.11076779238379,-46.8937921741634,0.264950675365015,52.0247415333297,0.0648560704811637,0.127483526948208,2.21686574406843,-2.05979738748996,13,1,0,
        11.2395230450177,22.1387458820362,-0.106196248088029,-13.5984087041741,0.428311982826498,-0.0337437392233119,-1.27708819874926,1.27381701962382,0,0,1,
        2.44617769137503,-49.7071771880379,0.247122766432405,54.9047208436672,0.0772233076294966,0.118707190227336,2.39657062567689,-2.40920589877635,14,1,0,
        11.9751447707090,23.2667991915926,-0.0965425043702344,-13.9696775136318,0.460941044645736,-0.0293418613318108,-1.36084474656966,1.46553651047953,0,0,1,
        2.79865760914851,-52.3389698615154,0.230423050753612,57.6337948621590,0.0904589170134387,0.110408087612373,2.56423119852311,-2.77849136622557,15,1,0,
        12.6970051356005,24.2953463813521,-0.0875109959703223,-14.2618225001667,0.492922898326435,-0.0252116495047079,-1.43797397563661,1.66625391037510,0,0,1,
        3.16680933963139,-54.8051282961610,0.214964026334795,60.2271229797783,0.104495904250535,0.102666932178824,2.72068126689807,-3.16631967012392,16,1,0,
        13.4059079323616,25.2325816645354,-0.0791347255801022,-14.4823706997034,0.524288529369711,-0.0213804961994775,-1.50892522130029,1.87523315985749,0,0,1,
        3.54935566588670,-57.1198733279345,0.200733650099226,62.6970568306300,0.119271247359710,0.0954969951377296,2.86679159125048,-3.57148187734146,17,1,0,
        14.1025937800731,26.0859090759391,-0.0714003550802342,-14.6376883466509,0.555069567287784,-0.0178497764749320,-1.57415517388010,2.09180128270517,0,0,1,
        3.94512666153484,-59.2956993844192,0.187654027477732,65.0537720153195,0.134726221707331,0.0888736909599340,3.00340125820036,-3.99287639287278,18,1,0,
        14.7877463781028,26.8619558517553,-0.0642700462199850,-14.7332104305799,0.585297071927873,-0.0146062498570187,-1.63410259167284,2.31534086684271,0,0,1,
        4.35304684941774,-61.3435484379579,0.175620300120673,67.3058221540050,0.150806385158787,0.0827545340665702,3.13128430416721,-4.42949338149332,19,1,0,
        15.4619983728571,27.5666434754393,-0.0576954239870000,-14.7736454458863,0.615000880915768,-0.0116296227715795,-1.68917576356918,2.54528337484551,0,0,1,
        4.77212400036219,-63.2730454221785,0.164523581105105,69.4605754288044,0.167461374699191,0.0770914701516530,3.25113865826439,-4.88040203447063,20,1,0,
        16.1259365695766,28.2052793736838,-0.0516260824623047,-14.7631434856063,0.644209295338063,-0.00889728054919750,-1.73974799340881,2.78110344678153,0,0,1,
        5.20143975885918,-65.0927334224244,0.154262684248912,71.5245353991986,0.184644615190737,0.0718377238058139,3.36358754352257,-5.34474050975741,21,1,0,
        16.7801064250324,28.7826491860089,-0.0460142866625657,-14.7054253368117,0.672948963357913,-0.00638701060299485,-1.78615781735093,3.02231418479831,0,0,1,
        5.64014195361334,-66.8102784320007,0.144748854653189,73.5035652772227,0.202313002396523,0.0669510407805565,3.46918675066628,-5.82170808079575,22,1,0,
        17.4250158645209,29.3030993930473,-0.0408171191999439,-14.6038763903616,0.701244874944250,-0.00407836814938766,-1.82871168083086,3.26846330309349,0,0,1,
        6.08743831377453,-68.4326340067940,0.135906573773280,75.4030385965560,0.220426595014565,0.0623947581176460,3.56843385910801,-6.31055898603036,23,1,0,
        18.0611385165162,29.7706061931649,-0.0359970447843710,-14.4616121534208,0.729120415191216,-0.00195318543713138,-1.86768758784530,3.51912998146858,0,0,1,
        6.54259128880730,-69.9661672299477,0.127672420529261,77.2279370658858,0.238948332392006,0.0581376906148681,3.66177731155555,-6.81059753274506,24,1,0,
        18.6889164726512,30.1888302533262,-0.0315216112181676,-14.2815226849011,0.756597445400861,4.41035755013863e-06,-1.90333884185488,3.77392225960813,0,0,1,
        7.00491370270743,-71.4167521115793,0.119993161774500,78.9829124452001,0.257843783584531,0.0541534638267516,3.74962438075375,-7.32117409914161,25,1,0,
        19.3087626743312,30.5611589773436,-0.0273627689235530,-14.0663024001234,0.783696394561454,0.00180822294539615,-1.93589743102718,4.03247483244644,0,0,1,
        7.47376502564904,-72.7898377067655,0.112823719177868,80.6723252122690,0.277080927352980,0.0504196672314880,3.83234771520930,-7.84168176678659,26,1,0,
        19.9210630110247,30.8907387321855,-0.0234960970273636,-13.8184702867266,0.810436351980455,0.00347030233302879,-1.96557688865960,4.29444713822597,0,0,1,
        7.94854809953844,-74.0904977087723,0.106125336345394,82.3002691803852,0.296629959804637,0.0469170300775257,3.91029049526322,-8.37155339142981,27,1,0,
        20.5261781963811,31.1804995134011,-0.0199000854235978,-13.5403841681204,0.836835156566181,0.00500126344532149,-1.99257461698558,4.55952166059822,0,0,1,
        8.42870620029793,-75.3234671012138,0.0998640769401933,83.8705882693724,0.316463125410948,0.0436287141581700,3.98377039208459,-8.91025898111325,28,1,0,
        21.1244454708549,31.4331741905269,-0.0165555346985989,-13.2342514747024,0.862909480884861,0.00641056637707366,-2.01707373802011,4.82740239044285,0,0,1,
        8.91372035646314,-76.4931701478337,0.0940096738215477,85.3868893544277,0.336554567197592,0.0405397531420464,4.05308257550911,-9.45730329656508,29,1,0,
        21.7161801652460,31.6513140060653,-0.0134450864691452,-12.9021380904056,0.888674909492740,0.00770674377552920,-2.03924456129581,5.09781341130445,0,0,1,
        9.40310687095649,-77.6037428012671,0.0885346916996161,86.8525534765412,0.356880192453677,0.0376366328092105,4.11850201000492,-10.0122236216282,30,1,0,
        22.3016771488090,31.8373015473181,-0.0105528722454108,-12.5459762075464,0.914146011692251,0.00889757564553814,-2.05924575819431,5.37049758519964,0,0,1;

    Eigen::Matrix<double, 60, 2> Rs;
    Rs <<1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0;

    Eigen::Matrix<double, 40, 1> dd;
    dd <<1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        2,
        33.6645000000000,
        2,
        33.6645000000000,
        2,
        33.6645000000000,
        2,
        33.6645000000000,
        2,
        33.6645000000000,
        2,
        6.33550000000000,
        2,
        6.33550000000000,
        2,
        6.33550000000000,
        2,
        6.33550000000000,
        2,
        6.33550000000000;
        
    Eigen::Matrix<double, 40, 2> dupast;
    dupast <<0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0;
    */                     
    
    /*
    //Aero Coeff tune (MPC Ts=0.12)
    Eigen::Matrix<double, 9, 9> A_MPC_SCR;
    A_MPC_SCR <<0.989780656400903,1.16099310373290,-0.0560897113396611,-0.869516412937119,0.0161164410694706,-0.00177037539053817,-0.0290388359848530,0.00562601451647795,0,
                -0.00547245032931277,0.519092660429121,0.0242333140461165,-0.195705584242428,-5.26750574636994e-05,-0.00846757644767125,0.0212812900462572,-0.00363903453378827,0,
                0.00878982518880148,-1.52536780532717,-0.0844640409187456,-3.36501458646057,6.35518356313520e-05,-0.0306169005008097,0.277689722977048,-0.0619155121549086,0,
                0.000425440848097476,-0.144769760141838,0.0409175940708903,0.747718179555819,2.18514423988828e-06,-0.00224675633483797,0.0248333127345347,-0.00469121181057435,0,
                0,0,0,0,0.618783391806141,0,0,0,0,
                0.00457696895418437,-0.672079420477098,-0.178301848907614,-2.48316667248874,3.45345662621867e-05,0.295042015103157,-0.0860446089738709,-0.0455678221290589,0,
                0.00621157012272818,-1.18824374806566,-0.353907950488122,-4.74844588934779,4.32112375756221e-05,-0.137248846876158,0.933042797450863,-0.0875991940786929,0,
                0.00681403584870462,-1.74984994624526,0.0195564943924962,2.13245647523522,4.25953560851138e-05,0.00931126577683167,0.00109305712988670,0.999460800373289,0,
                0.00681403584870462,-1.74984994624526,0.0195564943924962,2.13245647523522,4.25953560851138e-05,0.00931126577683166,0.00109305712988670,-0.000539199626710820,1;
    Eigen::Matrix<double, 9, 2> B_MPC_SCR;
    B_MPC_SCR <<-0.0168099369788316,0.00418458286030214,
                0.0108936390406341,-9.23672265362124e-06,
                0.186997997600028,8.74057695955310e-06,
                0.0140216721126549,2.28912031959613e-07,
                0,0.381216608193859,
                0.137975581810149,4.85936171643712e-06,
                0.263846485430390,5.78803646465494e-06,
                -0.118403067860802,5.34721811175451e-06,
                0.00159693213919787,5.34721811175451e-06;

    Eigen::Matrix<double, 2, 9> C_MPC_SCR;
    C_MPC_SCR <<0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	1.0,
                1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0;

    Eigen::Matrix<double, 40, 10> CC; 
    CC <<1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 1.0, 0.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 1.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	1.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 1.0,
        -1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, -1.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	-1.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, -1.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, -1.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, -1.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	-1.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, -1.0,
        1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 0.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 1.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 1.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 1.0, 0.0,	1.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 1.0,	0.0, 1.0,
        -1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, 0.0, 0.0, 0.0,	0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0, 0.0,	0.0, 0.0,
        0.0, -1.0, 0.0, -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0, 0.0,	-1.0, 0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0;

    Eigen::Matrix<double, 10, 10> E;
    E <<212.931451620163,-4.24346995820209,202.544596604233,-4.42019769197589,192.187439242362,-4.55933083382924,181.733577634085,-4.66034237399567,171.211971660328,-4.72308745218867,
        -4.24346995820209,4.49247652541697,-4.02541753076535,4.25475499557947,-3.80281481413500,4.03085014937436,-3.57737060079951,3.80631243545653,-3.35092920367249,3.58177511714959,
        202.544596604233,-4.02541753076535,193.171050849408,-4.20365142327192,183.364970516015,-4.34618789074505,173.593405960838,-4.45213145289482,163.730468592232,-4.52106817027241,
        -4.42019769197589,4.25475499557947,-4.20365142327192,4.06285928564271,-3.98140076546272,3.83942886221160,-3.75482269447998,3.62988151599990,-3.52563098038341,3.41976881051678,
        192.187439242362,-3.80281481413500,183.364970516015,-3.98140076546272,174.555062892640,-4.12662777878738,165.317299870413,-4.23713041785677,156.119230077646,-4.31212296055379,
        -4.55933083382924,4.03085014937436,-4.34618789074505,3.83942886221160,-4.12662777878738,3.66128502340392,-3.90158736403937,3.45167244575180,-3.67244935635100,3.25601020081403,
        181.733577634085,-3.57737060079951,173.593405960838,-3.75482269447998,165.317299870413,-3.90158736403937,157.058293837655,-4.01593723436891,148.376454467862,-4.09661328723450,
        -4.66034237399567,3.80631243545653,-4.45213145289482,3.62988151599990,-4.23713041785677,3.45167244575180,-4.01593723436891,3.28680631914653,-3.78949523216825,3.09053838995570,
        171.211971660328,-3.35092920367249,163.730468592232,-3.52563098038341,156.119230077646,-3.67244935635100,148.376454467862,-3.78949523216825,140.655644039953,-3.87514427963468,
        -4.72308745218867,3.58177511714959,-4.52106817027241,3.41976881051678,-4.31212296055379,3.25601020081403,-4.09661328723450,3.09053838995570,-3.87514427963468,2.93847606695978;                        
    
    Eigen::Matrix<double, 60, 10> H;
    H <<0.00159693213919787,5.34721811175451e-06,0,0,0,0,0,0,0,0,
        -0.0168099369788316,0.00418458286030214,0,0,0,0,0,0,0,0,
        0.0192116873423020,7.23170398900525e-05,0.00159693213919787,5.34721811175451e-06,0,0,0,0,0,0,
        -0.0520535861490272,0.0144586973634770,-0.0168099369788316,0.00418458286030214,0,0,0,0,0,0,
        0.0642626422698558,0.000314151284959497,0.0192116873423020,7.23170398900525e-05,0.00159693213919787,5.34721811175451e-06,0,0,0,0,
        -0.0957902171128732,0.0283649098266643,-0.0520535861490272,0.0144586973634770,-0.0168099369788316,0.00418458286030214,0,0,0,0,
        0.137882312992468,0.000862432542329752,0.0642626422698558,0.000314151284959497,0.0192116873423020,7.23170398900525e-05,0.00159693213919787,5.34721811175451e-06,0,0,
        -0.145562298181963,0.0443465731524125,-0.0957902171128732,0.0283649098266643,-0.0520535861490272,0.0144586973634770,-0.0168099369788316,0.00418458286030214,0,0,
        0.234900262476230,0.00184585764731223,0.137882312992468,0.000862432542329752,0.0642626422698558,0.000314151284959497,0.0192116873423020,7.23170398900525e-05,0.00159693213919787,5.34721811175451e-06,
        -0.200592107820584,0.0614200230239604,-0.145562298181963,0.0443465731524125,-0.0957902171128732,0.0283649098266643,-0.0520535861490272,0.0144586973634770,-0.0168099369788316,0.00418458286030214,
        0.347996916226176,0.00337788544589555,0.234900262476230,0.00184585764731223,0.137882312992468,0.000862432542329752,0.0642626422698558,0.000314151284959497,0.0192116873423020,7.23170398900525e-05,
        -0.259865514647052,0.0789665591079404,-0.200592107820584,0.0614200230239604,-0.145562298181963,0.0443465731524125,-0.0957902171128732,0.0283649098266643,-0.0520535861490272,0.0144586973634770,
        0.470291166159959,0.00554878023366709,0.347996916226176,0.00337788544589555,0.234900262476230,0.00184585764731223,0.137882312992468,0.000862432542329752,0.0642626422698558,0.000314151284959497,
        -0.321953777954439,0.0966001978737113,-0.259865514647052,0.0789665591079404,-0.200592107820584,0.0614200230239604,-0.145562298181963,0.0443465731524125,-0.0957902171128732,0.0283649098266643,
        0.596435416580957,0.00842152230904545,0.470291166159959,0.00554878023366709,0.347996916226176,0.00337788544589555,0.234900262476230,0.00184585764731223,0.137882312992468,0.000862432542329752,
        -0.385335224140593,0.114083826143141,-0.321953777954439,0.0966001978737113,-0.259865514647052,0.0789665591079404,-0.200592107820584,0.0614200230239604,-0.145562298181963,0.0443465731524125,
        0.722777954201929,0.0120313907516608,0.596435416580957,0.00842152230904545,0.470291166159959,0.00554878023366709,0.347996916226176,0.00337788544589555,0.234900262476230,0.00184585764731223,
        -0.448692087568801,0.131276081496816,-0.385335224140593,0.114083826143141,-0.321953777954439,0.0966001978737113,-0.259865514647052,0.0789665591079404,-0.200592107820584,0.0614200230239604,
        0.847095734694520,0.0163884653522350,0.722777954201929,0.0120313907516608,0.596435416580957,0.00842152230904545,0.470291166159959,0.00554878023366709,0.347996916226176,0.00337788544589555,
        -0.511050278054464,0.148097534313048,-0.448692087568801,0.131276081496816,-0.385335224140593,0.114083826143141,-0.321953777954439,0.0966001978737113,-0.259865514647052,0.0789665591079404,
        0.968210156298108,0.0214819330611895,0.847095734694520,0.0163884653522350,0.722777954201929,0.0120313907516608,0.596435416580957,0.00842152230904545,0.470291166159959,0.00554878023366709,
        -0.571788347196504,0.164508917043554,-0.511050278054464,0.148097534313048,-0.448692087568801,0.131276081496816,-0.385335224140593,0.114083826143141,-0.321953777954439,0.0966001978737113,
        1.08563525028025,0.0272851046099510,0.968210156298108,0.0214819330611895,0.847095734694520,0.0163884653522350,0.722777954201929,0.0120313907516608,0.596435416580957,0.00842152230904545,
        -0.630577021104591,0.180496895188734,-0.571788347196504,0.164508917043554,-0.511050278054464,0.148097534313048,-0.448692087568801,0.131276081496816,-0.385335224140593,0.114083826143141,
        1.19930766989554,0.0337603081177199,1.08563525028025,0.0272851046099510,0.968210156298108,0.0214819330611895,0.847095734694520,0.0163884653522350,0.722777954201929,0.0120313907516608,
        -0.687298131706680,0.196064625709209,-0.630577021104591,0.180496895188734,-0.571788347196504,0.164508917043554,-0.511050278054464,0.148097534313048,-0.448692087568801,0.131276081496816,
        1.30939943447859,0.0408631543758124,1.19930766989554,0.0337603081177199,1.08563525028025,0.0272851046099510,0.968210156298108,0.0214819330611895,0.847095734694520,0.0163884653522350,
        -0.741970043825981,0.211225423760061,-0.687298131706680,0.196064625709209,-0.630577021104591,0.180496895188734,-0.571788347196504,0.164508917043554,-0.511050278054464,0.148097534313048,
        1.41619700467175,0.0485459530580283,1.30939943447859,0.0408631543758124,1.19930766989554,0.0337603081177199,1.08563525028025,0.0272851046099510,0.968210156298108,0.0214819330611895,
        -0.794689912546873,0.225998499797837,-0.741970043825981,0.211225423760061,-0.687298131706680,0.196064625709209,-0.630577021104591,0.180496895188734,-0.571788347196504,0.164508917043554,
        1.52002784728803,0.0567602582684230,1.41619700467175,0.0485459530580283,1.30939943447859,0.0408631543758124,1.19930766989554,0.0337603081177199,1.08563525028025,0.0272851046099510,
        -0.845593646552066,0.240406106548838,-0.794689912546873,0.225998499797837,-0.741970043825981,0.211225423760061,-0.687298131706680,0.196064625709209,-0.630577021104591,0.180496895188734,
        1.62121876900667,0.0654586365874926,1.52002784728803,0.0567602582684230,1.41619700467175,0.0485459530580283,1.30939943447859,0.0408631543758124,1.19930766989554,0.0337603081177199,
        -0.894830469510349,0.254471659596907,-0.845593646552066,0.240406106548838,-0.794689912546873,0.225998499797837,-0.741970043825981,0.211225423760061,-0.687298131706680,0.196064625709209,
        1.72007449201802,0.0745958007629079,1.62121876900667,0.0654586365874926,1.52002784728803,0.0567602582684230,1.41619700467175,0.0485459530580283,1.30939943447859,0.0408631543758124,
        -0.942548082188363,0.268218533112762,-0.894830469510349,0.254471659596907,-0.845593646552066,0.240406106548838,-0.794689912546873,0.225998499797837,-0.741970043825981,0.211225423760061,
        1.81686856373644,0.0841292603022759,1.72007449201802,0.0745958007629079,1.62121876900667,0.0654586365874926,1.52002784728803,0.0567602582684230,1.41619700467175,0.0485459530580283,
        -0.988884900144553,0.281669321245596,-0.942548082188363,0.268218533112762,-0.894830469510349,0.254471659596907,-0.845593646552066,0.240406106548838,-0.794689912546873,0.225998499797837,
        1.91184138509045,0.0940196254652210,1.81686856373644,0.0841292603022759,1.72007449201802,0.0745958007629079,1.62121876900667,0.0654586365874926,1.52002784728803,0.0567602582684230,
        -1.03396670557101,0.294845416321143,-0.988884900144553,0.281669321245596,-0.942548082188363,0.268218533112762,-0.894830469510349,0.254471659596907,-0.845593646552066,0.240406106548838,
        2.00520202017444,0.104230676725112,1.91184138509045,0.0940196254652210,1.81686856373644,0.0841292603022759,1.72007449201802,0.0745958007629079,1.62121876900667,0.0654586365874926,
        -1.07790587395507,0.307766798024417,-1.03396670557101,0.294845416321143,-0.988884900144553,0.281669321245596,-0.942548082188363,0.268218533112762,-0.894830469510349,0.254471659596907,
        2.09713172287887,0.114729285671260,2.00520202017444,0.104230676725112,1.91184138509045,0.0940196254652210,1.81686856373644,0.0841292603022759,1.72007449201802,0.0745958007629079,
        -1.12080197882328,0.320451959004931,-1.07790587395507,0.307766798024417,-1.03396670557101,0.294845416321143,-0.988884900144553,0.281669321245596,-0.942548082188363,0.268218533112762,
        2.18778796415672,0.125485249719355,2.09713172287887,0.114729285671260,2.00520202017444,0.104230676725112,1.91184138509045,0.0940196254652210,1.81686856373644,0.0841292603022759,
        -1.16274303408985,0.332917915188849,-1.12080197882328,0.320451959004931,-1.07790587395507,0.307766798024417,-1.03396670557101,0.294845416321143,-0.988884900144553,0.281669321245596,
        2.27730829764783,0.136471083594452,2.18778796415672,0.125485249719355,2.09713172287887,0.114729285671260,2.00520202017444,0.104230676725112,1.91184138509045,0.0940196254652210,
        -1.20380693983661,0.345180265679007,-1.16274303408985,0.332917915188849,-1.12080197882328,0.320451959004931,-1.07790587395507,0.307766798024417,-1.03396670557101,0.294845416321143,
        2.36581375208975,0.147661795629475,2.27730829764783,0.136471083594452,2.18778796415672,0.125485249719355,2.09713172287887,0.114729285671260,2.00520202017444,0.104230676725112,
        -1.24406289506977,0.357253279012680,-1.20380693983661,0.345180265679007,-1.16274303408985,0.332917915188849,-1.12080197882328,0.320451959004931,-1.07790587395507,0.307766798024417,
        2.45341164985306,0.159034666049050,2.36581375208975,0.147661795629475,2.27730829764783,0.136471083594452,2.18778796415672,0.125485249719355,2.09713172287887,0.114729285671260,
        -1.28357266403880,0.369149990903558,-1.24406289506977,0.357253279012680,-1.20380693983661,0.345180265679007,-1.16274303408985,0.332917915188849,-1.12080197882328,0.320451959004931,
        2.54019786776424,0.170569036863732,2.45341164985306,0.159034666049050,2.36581375208975,0.147661795629475,2.27730829764783,0.136471083594452,2.18778796415672,0.125485249719355,
        -1.32239165584826,0.380882304336593,-1.28357266403880,0.369149990903558,-1.24406289506977,0.357253279012680,-1.20380693983661,0.345180265679007,-1.16274303408985,0.332917915188849,
        2.62625861230753,0.182246118018515,2.54019786776424,0.170569036863732,2.45341164985306,0.159034666049050,2.36581375208975,0.147661795629475,2.27730829764783,0.136471083594452,
        -1.36056981767669,0.392461086728196,-1.32239165584826,0.380882304336593,-1.28357266403880,0.369149990903558,-1.24406289506977,0.357253279012680,-1.20380693983661,0.345180265679007,
        2.71167180008707,0.194048811331259,2.62625861230753,0.182246118018515,2.54019786776424,0.170569036863732,2.45341164985306,0.159034666049050,2.36581375208975,0.147661795629475,
        -1.39815236186794,0.403896261359675,-1.36056981767669,0.392461086728196,-1.32239165584826,0.380882304336593,-1.28357266403880,0.369149990903558,-1.24406289506977,0.357253279012680,
        2.79650813249570,0.205961551952944,2.71167180008707,0.194048811331259,2.62625861230753,0.182246118018515,2.54019786776424,0.170569036863732,2.45341164985306,0.159034666049050,
        -1.43518035461143,0.415196891852845,-1.39815236186794,0.403896261359675,-1.36056981767669,0.392461086728196,-1.32239165584826,0.380882304336593,-1.28357266403880,0.369149990903558;

    Eigen::Matrix<double, 60, 11> P; 
    P <<0.00681403584870462,-1.74984994624526,0.0195564943924962,2.13245647523522,4.25953560851138e-05,0.00931126577683166,0.00109305712988670,-0.000539199626710820,1,1,0,
        0.989780656400903,1.16099310373290,-0.0560897113396611,-0.869516412937119,0.0161164410694706,-0.00177037539053817,-0.0290388359848530,0.00562601451647795,0,0,1,
        0.0310733045952372,-4.74528237714413,0.0798716937183998,6.10065045805589,0.000319787866333001,0.0306297601628907,0.0233538698828766,-0.00694590829076065,2,1,0,
        1.96207983668113,3.15007210838443,-0.103609706852760,-2.26448759550305,0.0419730724564223,-0.00616697500026012,-0.0971779885073941,0.0227689814813244,0,0,1,
        0.0807016355962163,-8.71792003779851,0.170948024702783,11.3900615433868,0.00109659245870728,0.0576748276992236,0.0942170594620315,-0.0281229485815928,3,1,0,
        2.91221988989394,5.63977934483226,-0.137774678777667,-4.01130219563123,0.0735295199195578,-0.0119274515338470,-0.194099531280137,0.0537901555410636,0,0,1,
        0.161847427313667,-13.4423130959052,0.269872624625476,17.4565418417150,0.00264939281065052,0.0839207080817097,0.229738832772576,-0.0729847230554460,4,1,0,
        3.83756484474449,8.40502974138912,-0.163388568295467,-5.97519135153896,0.108228802251793,-0.0178290163689259,-0.311475146998105,0.100142734538246,0,0,1,
        0.278938702800819,-18.6796612388749,0.356740920081833,23.8418092217995,0.00523386880615006,0.105159517478225,0.430195740286289,-0.148364427836242,5,1,0,
        4.73681977581933,11.3004795060915,-0.182974967627265,-8.03236224820014,0.144458529037050,-0.0228855356158390,-0.444338588087429,0.162963330591933,0,0,1,
        0.434617377928956,-24.1897003926110,0.420539652687643,30.2141563877973,0.00906432524892621,0.119657336884381,0.684245847193896,-0.258385846146541,6,1,0,
        5.60957196887569,14.2265535204273,-0.196616145432711,-10.0757971888783,0.181208173462276,-0.0264449523456092,-0.588821832343358,0.243005104699586,0,0,1,
        0.629839123339124,-29.7579652218923,0.458543107854837,36.3626697145890,0.0143011423755773,0.127464182881923,0.975192081367615,-0.404719447493722,7,1,0,
        6.45603479680357,17.1093641705268,-0.203786589968379,-12.0237341695238,0.217851482321366,-0.0282327843623106,-0.740843475710221,0.340515349694543,0,0,1,
        0.864147633875939,-35.2145975386377,0.473362674884621,42.1716130251497,0.0210462408196443,0.129610543112642,1.28599099084354,-0.587191295393855,8,1,0,
        7.27689149559785,19.8926994963392,-0.204476239208948,-13.8220664907317,0.254008679811411,-0.0283004308491734,-0.896021010153533,0.455225169617747,0,0,1,
        1.13603547690641,-40.4399283588612,0.470035437102763,47.5915574305126,0.0293456056575017,0.127483867405650,1.60213092297011,-0.804420941147857,9,1,0,
        8.07317419856966,22.5356227362075,-0.199419650191151,-15.4412204174628,0.289459034289064,-0.0269141578135522,-1.05013090010849,0.586438203652449,0,0,1,
        1.44330460480588,-45.3602207805458,0.454013359530319,52.6148913168994,0.0391967854267282,0.122444270313539,1.91271575875518,-1.05434464699347,10,1,0,
        8.84615491201545,25.0113001935091,-0.189855504105188,-16.8703762455937,0.324084912928843,-0.0244378315228629,-1.19958098072165,0.733162142216212,0,0,1,
        1.78337320012592,-49.9385428487456,0.430088747285303,57.2578209867526,0.0505589482942659,0.115637436238037,2.21042215632584,-1.33458982504556,11,1,0,
        9.59724709053340,27.3053151347217,-0.177183900303944,-18.1113999482964,0.357835485483335,-0.0212424881671979,-1.34167265757304,0.894237861757837,0,0,1,
        2.15350866116529,-54.1645968879197,0.401993653642377,61.5483441609218,0.0633634372475226,0.107937311729982,2.49091530037808,-1.64271752143958,12,1,0,
        10.3279227044897,29.4133018234160,-0.162703143337451,-19.1737475450055,0.390702799666084,-0.0176521393539255,-1.47464035116086,1.06844323299101,0,0,1,
        2.55098836670658,-58.0456603068469,0.372387268025315,65.5188120039107,0.0775234313370738,0.0999598793058461,2.75210821863122,-1.97636545739024,13,1,0,
        11.0396482945055,31.3383106885207,-0.147469830695475,-20.0707314844173,0.422705797497226,-0.0139207287422407,-1.59754115958065,1.25456580053641,0,0,1,
        2.97320043411972,-61.5994792025427,0.343020034825320,69.2016751961047,0.0929419829773459,0.0921076507881400,2.99346926202503,-2.33332312574870,14,1,0,
        11.7338402027265,33.0883386566445,-0.132259900327550,-20.8170546701530,0.453879558809029,-0.0102300485733817,-1.71007645783761,1.45144775843666,0,0,1,
        3.41769958146399,-64.8491726172317,0.314947977201527,72.6272903284925,0.109518210374770,0.0846213234084778,3.21546028597739,-2.71156370933445,15,1,0,
        12.4118365923945,34.6742866899908,-0.117590985502042,-21.4273318189652,0.484268071443683,-0.00669893315954248,-1.81240477514758,1.65800993389057,0,0,1,
        3.88223201229402,-67.8198431620463,0.288734188358627,75.8229840937553,0.127151746153991,0.0776269513783324,3.41911983268136,-3.10925032964866,16,1,0,
        13.0748826468850,36.1084289744012,-0.103772066327800,-21.9152991470601,0.513919424813899,-0.00339672387672162,-1.90497852603417,1.87326150784758,0,0,1,
        4.36474045513922,-70.5364860847561,0.264613243886711,78.8128393625538,0.145745706724736,0.0711742026877941,3.60577427715606,-3.52472820824201,17,1,0,
        13.7241252158616,37.4033604623101,-0.0909583959458419,-22.2934650109550,0.542882683430409,-0.000356826856986759,-1.98841681370087,2.09630089578449,0,0,1,
        4.86335749738025,-73.0228140501144,0.242614508889771,81.6178617148064,0.165208499909798,0.0652650971151666,3.77684972550496,-3.95651002895043,18,1,0,
        14.3606136755407,38.5713339702650,-0.0792003518434939,-22.5730216729593,0.571205923784377,0.00241165551699934,-2.06341440147269,2.32631166515207,0,0,1,
        5.37639277348305,-75.3006884461002,0.222649123319479,84.2563178711928,0.185454775824403,0.0598743492924905,3.93375763160208,-4.40325887001699,19,1,0,
        14.9853045003845,39.6238856094367,-0.0684820335607147,-22.7638980226451,0.598935068831750,0.00491487034278676,-2.13068128964407,2.56255603890866,0,0,1,
        5.90231757949162,-77.3899283559329,0.204568190333790,86.7441249053813,0.206405781583018,0.0549630122953881,4.07783137469411,-4.86377116749081,20,1,0,
        15.5990677658052,40.5716578208206,-0.0587493901817062,-22.8748780718665,0.626113259654828,0.00716765310664127,-2.19090569763569,2.80436754803658,0,0,1,
        6.43974906099326,-79.3083379839288,0.188199625500545,89.0952250614478,0.227989325768771,0.0504871200404234,4.21029626409090,-5.33696096412524,21,1,0,
        16.2026944050406,41.4243484033155,-0.0499294210280133,-22.9137410805583,0.652780579792495,0.00918905717201033,-2.24473367645659,3.05114372224047,0,0,1,
        6.98743515668642,-81.0718474492446,0.173369985924291,91.3219156889119,0.250139505892753,0.0464027905317429,4.33226024195187,-5.82184596205974,22,1,0,
        16.7969034987971,42.1907336232099,-0.0419424909112223,-22.8873993500781,0.678974003189124,0.0109994900213490,-2.29275981668720,3.30233927486260,0,0,1,
        7.54424085918882,-82.6947012014988,0.159916212430005,93.4351243489219,0.272796306987413,0.0426689466457615,4.44471648077910,-6.31753547284857,23,1,0,
        17.3823491952312,42.8787302158379,-0.0347096881479192,-22.8020222182286,0.704727477180597,0.0126190076076521,-2.33552490123555,3.55745997383344,0,0,1,
        8.10913597829577,-84.1896555159297,0.147690930407176,95.4446304297941,0.295905143787593,0.0392485167158876,4.54855206777625,-6.82322013475612,24,1,0,
        17.9596270674950,43.4954738607936,-0.0281568087349338,-22.6631421441536,0.730072081147102,0.0140663985022643,-2.37351757912117,3.81605723860081,0,0,1,
        8.68118438045546,-85.5681645066352,0.136563884010406,97.3592400154765,0.319416392305962,0.0361087263396431,4.64455914348990,-7.33816316904974,25,1,0,
        18.5292798453009,44.0474007930751,-0.0222161654483714,-22.4757428088893,0.755036222193061,0.0153587776753739,-2.40717810965462,4.07772342287060,0,0,1,
        9.25953457326451,-86.8405454126372,0.126421242968117,99.1869226017884,0.343284937693666,0.0332208944572251,4.73344637378482,-7.86169292281474,26,1,0,
        19.0918025306577,44.5403253114799,-0.0168270784042356,-22.2443311291563,0.779645843619933,0.0165114887387207,-2.43690294596485,4.34208770695830,0,0,1,
        9.84341146391437,-88.0161206064126,0.117163900088369,100.934918123017,0.367469752487037,0.0305599984032158,4.81584963792509,-8.39319646136955,27,1,0,
        19.6476469453082,44.9795098255001,-0.0119356296637718,-21.9729958216816,0.803924631725481,0.0175381773913711,-2.46304943134575,4.60881251325409,0,0,1,
        10.4321091176250,-89.1033373951890,0.108705435523400,102.609821656765,0.391933511134896,0.0281041670356296,4.89234144770022,-8.93211400685011,28,1,0,
        20.1972257723487,45.3697264031627,-0.00749405898979333,-21.6654552070987,0.827894212901059,0.0184509471693275,-2.48594021895277,4.87759036189484,0,0,1,
        11.0249843579158,-90.1098683569846,0.100970123263857,104.217651743946,0.416642241758820,0.0258341894709827,4.96343898452501,-9.47793405790886,29,1,0,
        20.7409161565341,45.7153100603215,-0.00346003118592617,-21.3250966517971,0.851574337101019,0.0192605433062242,-2.50586723929082,5.14814109380595,0,0,1,
        11.6214510738338,-91.0426954638501,0.0938911611335902,105.763906845230,0.441565013373339,0.0237330809691931,5.02961083959890,-10.0301890616560,30,1,0,
        21.2790629231035,46.0202046451115,0.000204094625599505,-20.9550096231577,0.874983046264638,0.0199765342354695,-2.52309516740906,5.42020940041185,0,0,1;
    
    Eigen::Matrix<double, 60, 2> Rs;
    Rs <<1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0;

    Eigen::Matrix<double, 40, 1> dd;
    dd <<1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000;

    Eigen::Matrix<double, 40, 2> dupast;
    dupast <<0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0;
    */

    /*
    //Aero Coeff tune MPC_Ts = 0.04 seconds better weights
    Eigen::Matrix<double, 9, 9> A_MPC_SCR; //Changed
    A_MPC_SCR <<0.997546498676791,0.410925657443648,-0.0340712300982580,-0.349724842652303,0.00627367322239273,-3.82541130721994e-05,-0.00483163301565940,0.000782969768729780,0,
                -0.00222968337861208,0.831959255891170,0.0224955490913446,-0.0386105404942000,-7.40602282643325e-06,-0.00408626496770071,0.00479675054861076,-0.000708734103698010,0,
                0.00157114046670309,-1.14374352318731,0.475209224965375,-1.70444726610408,3.62128894703726e-06,-0.0146689101199293,0.189637716791016,-0.0319400554975835,0,
                2.22008969471445e-05,-0.0258337042550531,0.0288188047240689,0.963566412853132,3.77914823207424e-08,-0.000304219425077316,0.00423684802254123,-0.000684422168354165,0,
                0,0,0,0,0.852143788966211,0,0,0,0,
                0.000900959404197834,-0.643577320399308,-0.0756798305519599,-1.47850678915832,2.09268174084895e-06,0.656460572913283,-0.0103098435348328,-0.0276977605942141,0,
                0.000995143461188211,-0.751468646037339,-0.119771958943435,-1.94879461517759,2.25456154900944e-06,-0.0720028326325681,1.01089064452709,-0.0365220501257017,0,
                0.000831700488826953,-0.666692627397094,0.00223876907256576,0.722096388884442,1.83420726850657e-06,0.00150351773517444,-0.000312704196564786,1.00003231489146,0,
                0.000831700488826953,-0.666692627397095,0.00223876907256576,0.722096388884442,1.83420726850657e-06,0.00150351773517444,-0.000312704196564786,3.23148914569059e-05,1;

    Eigen::Matrix<double, 9, 2> B_MPC_SCR;//Changed
    B_MPC_SCR <<-0.00231629867458615,0.000515494516102596,
                0.00209805994032892,-4.06357835856020e-07,
                0.0947301411334613,1.51165929282970e-07,
                0.00202467952562444,1.24377936766354e-09,
                0,0.147856211033789,
                0.0821613613886360,8.77409171478794e-08,
                0.108290966301961,9.31080355805084e-08,
                -0.0400957371369367,7.45345032784656e-08,
                -9.57371369367099e-05,7.45345032784656e-08;

    Eigen::Matrix<double, 2, 9> C_MPC_SCR;
    C_MPC_SCR <<0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	1.0,
                1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0;

     Eigen::Matrix<double, 40, 10> CC; 
    CC <<1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 1.0, 0.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 1.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	1.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 1.0,
        -1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, -1.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	-1.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, -1.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, -1.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, -1.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	-1.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, -1.0,
        1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 0.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 1.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 1.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 1.0, 0.0,	1.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 1.0,	0.0, 1.0,
        -1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, 0.0, 0.0, 0.0,	0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0, 0.0,	0.0, 0.0,
        0.0, -1.0, 0.0, -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0, 0.0,	-1.0, 0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0;

    Eigen::Matrix<double, 10, 10> E;//Changed
    E <<15.3066071764275,-1.19438230609882,14.1376077019047,-1.13643293303589,13.1311131365625,-1.07741765475879,12.1404121521609,-1.01754817997575,11.1689767316792,-0.957055830189756,
        -1.19438230609882,0.418637478704122,-1.12457330962138,0.380628656767472,-1.05549328362102,0.357739748408494,-0.987316732174179,0.335024281353322,-0.920226471454563,0.312540746304150,
        14.1376077019047,-1.12457330962138,13.3491200355531,-1.07077693211523,12.2708787721892,-1.01591264784555,11.3558672616722,-0.960168106771632,10.4572794756638,-0.903754303650405,
        -1.13643293303589,0.380628656767472,-1.07077693211523,0.374234555771711,-1.00573050840214,0.337923747355729,-0.941450744220201,0.316743395873156,-0.878106791424347,0.295746601324462,
        13.1311131365625,-1.05549328362102,12.2708787721892,-1.00573050840214,11.5689157224488,-0.954915954122190,10.5778900984178,-0.903210502758751,9.75069495720006,-0.850801113297533,
        -1.07741765475879,0.357739748408494,-1.01591264784555,0.337923747355729,-0.954915954122190,0.333161055585714,-0.894565716195398,0.298491955603012,-0.835013787640769,0.278963200877338,
        12.1404121521609,-0.987316732174179,11.3558672616722,-0.941450744220201,10.5778900984178,-0.894565716195398,9.95884118138422,-0.846797211054970,9.05130077144152,-0.798305442960502,
        -1.01754817997575,0.335024281353322,-0.960168106771632,0.316743395873156,-0.903210502758751,0.298491955603012,-0.846797211054970,0.295303862030012,-0.791061277994103,0.262219003671939,
        11.1689767316792,-0.920226471454563,10.4572794756638,-0.878106791424347,9.75069495720006,-0.835013787640769,9.05130077144152,-0.791061277994103,8.51137606032987,-0.746384180933033,
        -0.957055830189756,0.312540746304150,-0.903754303650405,0.295746601324462,-0.850801113297533,0.278963200877338,-0.798305442960502,0.262219003671939,-0.746384180933033,0.260547534156857;                
    
    Eigen::Matrix<double, 60, 10> H;//Changed
    H <<-9.57371369367099e-05,7.45345032784656e-08,0,0,0,0,0,0,0,0,
        -0.00231629867458615,0.000515494516102596,0,0,0,0,0,0,0,0,
        0.000170303184630982,1.12126252533256e-06,-9.57371369367099e-05,7.45345032784656e-08,0,0,0,0,0,0,
        -0.00825817977941647,0.00195715285454235,-0.00231629867458615,0.000515494516102596,0,0,0,0,0,0,
        0.00159693213919787,5.34721811175451e-06,0.000170303184630982,1.12126252533256e-06,-9.57371369367099e-05,7.45345032784656e-08,0,0,0,0,
        -0.0168099369788316,0.00418458286030213,-0.00825817977941647,0.00195715285454235,-0.00231629867458615,0.000515494516102596,0,0,0,0,
        0.00488926611661475,1.59498910666152e-05,0.00159693213919787,5.34721811175451e-06,0.000170303184630982,1.12126252533256e-06,-9.57371369367099e-05,7.45345032784656e-08,0,0,
        -0.0272562890897740,0.00707724149396637,-0.0168099369788316,0.00418458286030213,-0.00825817977941647,0.00195715285454235,-0.00231629867458615,0.000515494516102596,0,0,
        0.0106195429152721,3.68190164550441e-05,0.00488926611661475,1.59498910666152e-05,0.00159693213919787,5.34721811175451e-06,0.000170303184630982,1.12126252533256e-06,-9.57371369367099e-05,7.45345032784656e-08,
        -0.0391104282138967,0.0105315931026163,-0.0272562890897740,0.00707724149396637,-0.0168099369788316,0.00418458286030213,-0.00825817977941647,0.00195715285454235,-0.00231629867458615,0.000515494516102596,
        0.0192116873423020,7.23170398900526e-05,0.0106195429152721,3.68190164550441e-05,0.00488926611661475,1.59498910666152e-05,0.00159693213919787,5.34721811175451e-06,0.000170303184630982,1.12126252533256e-06,
        -0.0520535861490272,0.0144586973634770,-0.0391104282138967,0.0105315931026163,-0.0272562890897740,0.00707724149396637,-0.0168099369788316,0.00418458286030213,-0.00825817977941647,0.00195715285454235,
        0.0309422333131586,0.000127116464934004,0.0192116873423020,7.23170398900526e-05,0.0106195429152721,3.68190164550441e-05,0.00488926611661475,1.59498910666152e-05,0.00159693213919787,5.34721811175451e-06,
        -0.0658859051238453,0.0187821531572924,-0.0520535861490272,0.0144586973634770,-0.0391104282138967,0.0105315931026163,-0.0272562890897740,0.00707724149396637,-0.0168099369788316,0.00418458286030213,
        0.0459517927032407,0.000206077187254660,0.0309422333131586,0.000127116464934004,0.0192116873423020,7.23170398900526e-05,0.0106195429152721,3.68190164550441e-05,0.00488926611661475,1.59498910666152e-05,
        -0.0804877479444261,0.0234363399449217,-0.0658859051238453,0.0187821531572924,-0.0520535861490272,0.0144586973634770,-0.0391104282138967,0.0105315931026163,-0.0272562890897740,0.00707724149396637,
        0.0642626422698558,0.000314151284959497,0.0459517927032407,0.000206077187254660,0.0309422333131586,0.000127116464934004,0.0192116873423020,7.23170398900526e-05,0.0106195429152721,3.68190164550441e-05,
        -0.0957902171128732,0.0283649098266643,-0.0804877479444261,0.0234363399449217,-0.0658859051238453,0.0187821531572924,-0.0520535861490272,0.0144586973634770,-0.0391104282138967,0.0105315931026163,
        0.0857991670607256,0.000456306387091448,0.0642626422698558,0.000314151284959497,0.0459517927032407,0.000206077187254660,0.0309422333131586,0.000127116464934004,0.0192116873423020,7.23170398900526e-05,
        -0.111753495568434,0.0335194923024786,-0.0957902171128732,0.0283649098266643,-0.0804877479444261,0.0234363399449217,-0.0658859051238453,0.0187821531572924,-0.0520535861490272,0.0144586973634770,
        0.110408856481030,0.000637461646181530,0.0857991670607256,0.000456306387091448,0.0642626422698558,0.000314151284959497,0.0459517927032407,0.000206077187254660,0.0309422333131586,0.000127116464934004,
        -0.128351609765911,0.0388585805324390,-0.111753495568434,0.0335194923024786,-0.0957902171128732,0.0283649098266643,-0.0804877479444261,0.0234363399449217,-0.0658859051238453,0.0187821531572924,
        0.137882312992468,0.000862432542329752,0.110408856481030,0.000637461646181530,0.0857991670607256,0.000456306387091448,0.0642626422698558,0.000314151284959497,0.0459517927032407,0.000206077187254660,
        -0.145562298181963,0.0443465731524125,-0.128351609765911,0.0388585805324390,-0.111753495568434,0.0335194923024786,-0.0957902171128732,0.0283649098266643,-0.0804877479444261,0.0234363399449217,
        0.167971324879646,0.00113588233478300,0.137882312992468,0.000862432542329752,0.110408856481030,0.000637461646181530,0.0857991670607256,0.000456306387091448,0.0642626422698558,0.000314151284959497,
        -0.163360806196634,0.0499529498260630,-0.145562298181963,0.0443465731524125,-0.128351609765911,0.0388585805324390,-0.111753495568434,0.0335194923024786,-0.0957902171128732,0.0283649098266643,
        0.200404498072690,0.00146227905872934,0.167971324879646,0.00113588233478300,0.137882312992468,0.000862432542329752,0.110408856481030,0.000637461646181530,0.0857991670607256,0.000456306387091448,
        -0.181716593024577,0.0556515620035428,-0.163360806196634,0.0499529498260630,-0.145562298181963,0.0443465731524125,-0.128351609765911,0.0388585805324390,-0.111753495568434,0.0335194923024786,
        0.234900262476230,0.00184585764731223,0.200404498072690,0.00146227905872934,0.167971324879646,0.00113588233478300,0.137882312992468,0.000862432542329752,0.110408856481030,0.000637461646181530,
        -0.200592107820584,0.0614200230239604,-0.181716593024577,0.0556515620035428,-0.163360806196634,0.0499529498260630,-0.145562298181963,0.0443465731524125,-0.128351609765911,0.0388585805324390,
        0.271177289198660,0.00229058714053501,0.234900262476230,0.00184585764731223,0.200404498072690,0.00146227905872934,0.167971324879646,0.00113588233478300,0.137882312992468,0.000862432542329752,
        -0.219942956866304,0.0672391838985861,-0.200592107820584,0.0614200230239604,-0.181716593024577,0.0556515620035428,-0.163360806196634,0.0499529498260630,-0.145562298181963,0.0443465731524125,
        0.308962497844535,0.00280014310939673,0.271177289198660,0.00229058714053501,0.234900262476230,0.00184585764731223,0.200404498072690,0.00146227905872934,0.167971324879646,0.00113588233478300,
        -0.239718933677728,0.0730926829568767,-0.219942956866304,0.0672391838985861,-0.200592107820584,0.0614200230239604,-0.181716593024577,0.0556515620035428,-0.163360806196634,0.0499529498260630,
        0.347996916226176,0.00337788544589555,0.308962497844535,0.00280014310939673,0.271177289198660,0.00229058714053501,0.234900262476230,0.00184585764731223,0.200404498072690,0.00146227905872934,
        -0.259865514647052,0.0789665591079404,-0.239718933677728,0.0730926829568767,-0.219942956866304,0.0672391838985861,-0.200592107820584,0.0614200230239604,-0.181716593024577,0.0556515620035428,
        0.388039694157053,0.00402684160320158,0.347996916226176,0.00337788544589555,0.308962497844535,0.00280014310939673,0.271177289198660,0.00229058714053501,0.234900262476230,0.00184585764731223,
        -0.280325532902007,0.0848489198231791,-0.259865514647052,0.0789665591079404,-0.239718933677728,0.0730926829568767,-0.219942956866304,0.0672391838985861,-0.200592107820584,0.0614200230239604,
        0.428870581257645,0.00474969525746121,0.388039694157053,0.00402684160320158,0.347996916226176,0.00337788544589555,0.308962497844535,0.00280014310939673,0.271177289198660,0.00229058714053501,
        -0.301040832757304,0.0907296561222684,-0.280325532902007,0.0848489198231791,-0.259865514647052,0.0789665591079404,-0.239718933677728,0.0730926829568767,-0.219942956866304,0.0672391838985861,
        0.470291166159959,0.00554878023366709,0.428870581257645,0.00474969525746121,0.388039694157053,0.00402684160320158,0.347996916226176,0.00337788544589555,0.308962497844535,0.00280014310939673,
        -0.321953777954439,0.0966001978737113,-0.301040832757304,0.0907296561222684,-0.280325532902007,0.0848489198231791,-0.259865514647052,0.0789665591079404,-0.239718933677728,0.0730926829568767,
        0.512125149044569,0.00642607941335377,0.470291166159959,0.00554878023366709,0.428870581257645,0.00474969525746121,0.388039694157053,0.00402684160320158,0.347996916226176,0.00337788544589555,
        -0.343008541008013,0.102453303624386,-0.321953777954439,0.0966001978737113,-0.301040832757304,0.0907296561222684,-0.280325532902007,0.0848489198231791,-0.259865514647052,0.0789665591079404,
        0.554217887004641,0.00738322823432793,0.512125149044569,0.00642607941335377,0.470291166159959,0.00554878023366709,0.428870581257645,0.00474969525746121,0.388039694157053,0.00402684160320158,
        -0.364152140856623,0.108282879966029,-0.343008541008013,0.102453303624386,-0.321953777954439,0.0966001978737113,-0.301040832757304,0.0907296561222684,-0.280325532902007,0.0848489198231791,
        0.596435416580957,0.00842152230904545,0.554217887004641,0.00738322823432793,0.512125149044569,0.00642607941335377,0.470291166159959,0.00554878023366709,0.428870581257645,0.00474969525746121,
        -0.385335224140592,0.114083826143141,-0.364152140856623,0.108282879966029,-0.343008541008013,0.102453303624386,-0.321953777954439,0.0966001978737113,-0.301040832757304,0.0907296561222684,
        0.638663122901050,0.00954192863110401,0.596435416580957,0.00842152230904545,0.554217887004641,0.00738322823432793,0.512125149044569,0.00642607941335377,0.470291166159959,0.00554878023366709,
        -0.406512604144698,0.119851900216883,-0.385335224140592,0.114083826143141,-0.364152140856623,0.108282879966029,-0.343008541008013,0.102453303624386,-0.321953777954439,0.0966001978737113,
        0.680804192097711,0.0107450998081287,0.638663122901050,0.00954192863110401,0.596435416580957,0.00842152230904545,0.554217887004641,0.00738322823432793,0.512125149044569,0.00642607941335377,
        -0.427643582861041,0.125583603632002,-0.406512604144698,0.119851900216883,-0.385335224140592,0.114083826143141,-0.364152140856623,0.108282879966029,-0.343008541008013,0.102453303624386,
        0.722777954201929,0.0120313907516608,0.680804192097711,0.0107450998081287,0.638663122901050,0.00954192863110401,0.596435416580957,0.00842152230904545,0.554217887004641,0.00738322823432793,
        -0.448692087568800,0.131276081496816,-0.427643582861041,0.125583603632002,-0.406512604144698,0.119851900216883,-0.385335224140592,0.114083826143141,-0.364152140856623,0.108282879966029,
        0.764518198048374,0.0134008772669955,0.722777954201929,0.0120313907516608,0.680804192097711,0.0107450998081287,0.638663122901050,0.00954192863110401,0.596435416580957,0.00842152230904545,
        -0.469626655317979,0.136927036286943,-0.448692087568800,0.131276081496816,-0.427643582861041,0.125583603632002,-0.406512604144698,0.119851900216883,-0.385335224140592,0.114083826143141,
        0.805971518033993,0.0148533760142499,0.764518198048374,0.0134008772669955,0.722777954201929,0.0120313907516608,0.680804192097711,0.0107450998081287,0.638663122901050,0.00954192863110401,
        -0.490420297979319,0.142534653028579,-0.469626655317979,0.136927036286943,-0.448692087568800,0.131276081496816,-0.427643582861041,0.125583603632002,-0.406512604144698,0.119851900216883,
        0.847095734694521,0.0163884653522350,0.805971518033993,0.0148533760142499,0.764518198048374,0.0134008772669955,0.722777954201929,0.0120313907516608,0.680804192097711,0.0107450998081287,
        -0.511050278054464,0.148097534313048,-0.490420297979319,0.142534653028579,-0.469626655317979,0.136927036286943,-0.448692087568800,0.131276081496816,-0.427643582861041,0.125583603632002;

    Eigen::Matrix<double, 60, 11> P; //Changed
    P <<0.000831700488826953,-0.666692627397095,0.00223876907256576,0.722096388884442,1.83420726850657e-06,0.00150351773517444,-0.000312704196564786,3.23148914569059e-05,1,1,0,
        0.997546498676791,0.410925657443648,-0.0340712300982580,-0.349724842652303,0.00627367322239273,-3.82541130721994e-05,-0.00483163301565940,0.000782969768729780,0,0,1,
        0.00400019326559998,-1.90967377871804,0.0112491624693636,2.16002500702177,1.54246777391442e-05,0.00648833461911893,-0.000675038262634731,-2.58439439189187e-05,2,1,0,
        1.99166379526025,1.21385338937178,-0.0845011407801530,-0.983330394791632,0.0178748361893715,-0.000825428430096765,-0.0205073280899910,0.00356089367469121,0,0,1,
        0.0108142291143046,-3.65952372496330,0.0308056568618598,4.29248148225698,5.80200338242581e-05,0.0157996003959506,0.000418018867251974,-0.000565043570629738,3,1,0,
        2.98144445166115,2.37484649310468,-0.140590852119814,-1.85284680772875,0.0339912772588421,-0.00259580382063494,-0.0495461640748439,0.00918690819116917,0,0,1,
        0.0224319553607802,-5.86313145033829,0.0633599015152106,7.08490164112180,0.000152032441389413,0.0295505658195234,0.00543147314900889,-0.00220839011126998,4,1,0,
        3.96607479034120,3.85329711846676,-0.196284875885964,-2.92278835507657,0.0539254696423441,-0.00535333811505258,-0.0924187549640672,0.0182614554955113,0,0,1,
        0.0398953784266724,-8.47925581859143,0.109930942189314,10.4919250471467,0.000323445008343312,0.0473946333653326,0.0174238498628197,-0.00576355780825913,5,1,0,
        4.94484400210092,5.60720006291802,-0.248510694743418,-4.16607442999677,0.0770782395168905,-0.00899949845462106,-0.148493144741847,0.0312127378146121,0,0,1,
        0.0641546471732050,-11.4746882494903,0.170246141515217,14.4601190299673,0.000600637518591199,0.0687131277513917,0.0396846626158096,-0.0121702664723090,6,1,0,
        5.91714318238114,7.59627906756955,-0.296030690256517,-5.56104561256271,0.102934870903842,-0.0133960980643430,-0.216632297264388,0.0483557047794585,0,0,1,
        0.0960838546171473,-14.8211652224481,0.243001472449570,18.9306734281159,0.00101351000016585,0.0927461650087288,0.0754225363110598,-0.0224487837007828,7,1,0,
        6.88245866716534,9.78364729493824,-0.338663764464608,-7.08936576740244,0.131053238728283,-0.0183939600365790,-0.295552102860207,0.0699336764590620,0,0,1,
        0.136490235897255,-18.4930446278952,0.326159353199495,23.8418802398734,0.00159281285760277,0.118683841376733,0.127524080505422,-0.0376529937943288,8,1,0,
        7.84036260493482,12.1365013067911,-0.376772266216513,-8.73461894499493,0.161053644480591,-0.0238447349875239,-0.384018505852886,0.0961463574410942,0,0,1,
        0.186118566898234,-22.4656822885496,0.417235684183878,29.1312913252044,0.00236961744997706,0.145728908913066,0.198387270084577,-0.0588300340851610,9,1,0,
        8.79050265814763,14.6262085432389,-0.410937238141419,-10.4814335451231,0.192610091943727,-0.0296052115211108,-0.480940048625629,0.127167531500833,0,0,1,
        0.245652355345976,-26.7144055594165,0.513550107623256,34.7375052207956,0.00337488146980308,0.173138476244561,0.289823693607732,-0.0869873725819564,10,1,0,
        9.73259198334966,17.2280423307502,-0.441765081664310,-12.3149921908918,0.225442788624903,-0.0355388431278557,-0.585395619059950,0.163155213996505,0,0,1,
        0.315713140970583,-31.2139666376380,0.612428101635799,40.6015748704959,0.00463907935541813,0.200250062554271,0.403019243601437,-0.123067412230536,11,1,0,
        10.6664001208108,19.9207385802602,-0.469783715693711,-14.2208115907940,0.259311695669705,-0.0415166392838419,-0.696624970088146,0.204256529658087,0,0,1,
        0.396858932688033,-35.9383596957447,0.711352701558491,46.6680551688241,0.00619187970736137,0.226495942936758,0.538541016911981,-0.167929186704390,12,1,0,
        11.5917450756614,22.6859889768170,-0.495397605211511,-16.1847007467018,0.294010978001941,-0.0474182041189208,-0.814000585806115,0.250609108655270,0,0,1,
        0.489582538528227,-40.8608965994056,0.808069084061545,52.8857257840180,0.00806185990998409,0.251408804782313,0.696378231669624,-0.222336398729887,13,1,0,
        12.5084866482905,25.5079421605322,-0.518879605139069,-18.1928272816361,0.329364229346118,-0.0531330430131830,-0.936992918357920,0.302340371972923,0,0,1,
        0.594310304613772,-45.9544512412846,0.900648148969974,59.2080334312295,0.0102762535633819,0.274621088252349,0.876006068262128,-0.286950891847952,14,1,0,
        13.4165209374823,28.3727535676510,-0.540384056284419,-20.2318399908686,0.365220365212735,-0.0585619853447101,-1.06513632732891,0.359565716529815,0,0,1,
        0.711401580100924,-51.1917993842544,0.987516444426331,65.5933008113140,0.0128607295588815,0.295859897648864,1.07646297577584,-0.362330596628748,15,1,0,
        14.3157758685572,31.2682033323535,-0.559970455616217,-22.2890108875298,0.401450091997991,-0.0636185045916232,-1.19799976841824,0.422386312583502,0,0,1,
        0.841149066885802,-56.5459974290295,1.06745991280146,72.0047485922518,0.0158392032633632,0.314938983911431,1.29643380479803,-0.448931017640199,16,1,0,
        15.2062075702483,34.1833875928047,-0.577630657029129,-24.3523721717781,0.437942872892083,-0.0682297467815718,-1.33516405041901,0.490886987671857,0,0,1,
        0.983780093626766,-61.9907585623854,1.13960841821902,78.4103734785633,0.0192336808025775,0.331748979505562,1.53433291366760,-0.547109400547880,17,1,0,
        16.0877974229263,37.1084798126333,-0.593315216362346,-26.4108329903875,0.474604321894266,-0.0723371441535198,-1.47620603507839,0.565134486834087,0,0,1,
        1.13945876875490,-67.5007977161215,1.20340715082483,84.7827206445611,0.0230641372453536,0.346246798911717,1.78838302057521,-0.657130818858179,18,1,0,
        16.9605496159827,40.0345538269690,-0.606956394167792,-28.4542679310656,0.511353966319491,-0.0758965608832900,-1.62068927933432,0.645176260941740,0,0,1,
        1.30828891122835,-73.0521274643528,1.25857999050508,91.0985833743679,0.0273484288933654,0.358444891947954,2.05668697351679,-0.779175531844918,19,1,0,
        17.8244890758261,42.9534580851567,-0.618486647073667,-30.4735742949145,0.548123326050613,-0.0788779768324189,-1.76816014789055,0.731039836040109,0,0,1,
        1.49031762524373,-78.6222954428328,1.30508888555123,97.3386572005356,0.0321022390992196,0.368400848089509,2.33729076125931,-0.913347078495590,20,1,0,
        18.6796596526660,45.8577300989610,-0.627852314908550,-32.4606986832759,0.584854264656507,-0.0812647581671647,-1.91814822904823,0.822732749252966,0,0,1,
        1.68553937065390,-84.1905602721141,1.34309234071842,103.487170527327,0.0373390562258707,0.376207694087051,2.62823699543303,-1.05968067984277,21,1,0,
        19.5261224805939,48.7405407490605,-0.635022759444219,-34.4086356639215,0.621497573515597,-0.0830525901838661,-2.07016987241509,0.920242994247922,0,0,1,
        1.89390037972284,-89.7380075685373,1.37290525900896,109.531508887725,0.0430701816248108,0.381985101259852,2.92760877698667,-1.21815161953538,22,1,0,
        20.3639544493495,51.5956593690359,-0.639995521801593,-36.3114025473429,0.658011755371692,-0.0842481600652340,-2.22373376290789,1.02353989552919,0,0,1,
        2.11530327903732,-95.2476107263702,1.39496166213539,115.461845734048,0.0493047649085952,0.385871619589328,3.23356434835419,-1.38868335773371,23,1,0,
        21.1932467465123,54.4174320738634,-0.642798209888792,-38.1639948625637,0.694361978393667,-0.0848676787887958,-2.37834760058243,1.13257532086167,0,0,1,
        2.34961178957414,-100.704243043116,1.40978122916517,121.270789044609,0.0560498633526622,0.388017979820047,3.54436325783011,-1.57115520563384,24,1,0,
        22.0141034453066,57.2007673996757,-0.643487859129361,-39.9623271837716,0.730519175883712,-0.0849353252756585,-2.53352513502574,1.24728514078487,0,0,1,
        2.59665539547310,-106.094648709770,1.41794013405560,126.953050035452,0.0633105219870775,0.388581448823353,3.85838495666592,-1.76540944739850,25,1,0,
        22.8266401258226,59.9411248282593,-0.642148470251057,-41.7031636919593,0.766459270340626,-0.0844816849902932,-2.68879298297496,1.36759085014488,0,0,1,
        2.85623389099730,-111.407380438836,1.42004631739897,132.505137856124,0.0710898708206542,0.387721184210385,4.17414084179653,-1.97125784389125,26,1,0,
        23.6309825265892,62.6345031006201,-0.638887347237617,-43.3840423893940,0.802162503687575,-0.0835422419147416,-2.84369682404481,1.49340127630997,0,0,1,
        3.12812173402777,-116.632711259060,1.41671907961711,137.925082261487,0.0793892356585116,0.385594508503393,4.49028077392310,-2.18848748964525,27,1,0,
        24.4272652295610,65.2774263404884,-0.633830758219820,-45.0031963161251,0.837612858165228,-0.0821559688791205,-2.99780671399977,1.62461431034467,0,0,1,
        3.41207215224655,-121.762527434195,1.40857271526343,143.212184818701,0.0882082591054977,0.382354008267233,4.80559506399280,-2.41686602237939,28,1,0,
        25.2156303852617,67.8669269025349,-0.627119336826937,-46.5594745166232,0.872797554715096,-0.0803640478598013,-3.15072137452209,1.76111860953928,0,0,1,
        3.70782096428220,-126.790208695737,1.39620380487305,148.366798158540,0.0975450285664951,0.378145356974030,5.11901284899988,-2.65614620456174,29,1,0,
        25.9962264865773,70.4005245424906,-0.618903540864499,-48.0522649187335,0.907706617674762,-0.0782087398355356,-3.30207141260768,1.90279523140521,0,0,1,
        4.01509009218166,-131.710501117422,1.38018172730060,153.390132044927,0.107396208335722,0.373105759881919,5.42959768478496,-2.90606991040736,30,1,0,
        26.7692072000231,72.8762019997923,-0.609339394778535,-49.4814207468644,0.942332496314542,-0.0757324135448463,-3.45152149322084,2.04951916996897,0,0,1;

    Eigen::Matrix<double, 60, 2> Rs;
    Rs <<1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0;    
    
    Eigen::Matrix<double, 40, 1> dd;
    dd <<1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000;

    Eigen::Matrix<double, 40, 2> dupast;
    dupast <<0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0;
    */

    //Aero Coeff tune (MPC Ts=0.08)
    Eigen::Matrix<double, 9, 9> A_MPC_SCR;
    A_MPC_SCR <<0.994117296583461,0.802927731928133,-0.0504299106818950,-0.633605552139330,0.0116011629669788,-0.000787174317024567,-0.0156756950743316,0.00277792390596143,0,
                -0.00404422965157559,0.666006011685161,0.0281018760989965,-0.110707003500327,-2.63798434133523e-05,-0.00674667684162920,0.0129952322347532,-0.00205423063033697,0,
                0.00497518786148901,-1.56215969606169,0.129246358699955,-2.77964679050302,2.34079955865293e-05,-0.0251107328177309,0.269266480556146,-0.0516605572030864,0,
                0.000149790784941794,-0.0818690479505680,0.0403959297978421,0.872028613230864,5.11246003189018e-07,-0.00111611572299814,0.0137099321823849,-0.00239239029046999,0,
                0,0,0,0,0.726149037073691,0,0,0,0,
                0.00274014304434448,-0.806575977610195,-0.141588877717710,-2.24160352182853,1.31717209086130e-05,0.435830901764444,-0.0408888607723158,-0.0416186353803174,0,
                0.00334752964385771,-1.12641363184991,-0.245726231859597,-3.53491547277187,1.52838798977577e-05,-0.114688474986807,0.988074210479829,-0.0657560200259900,0,
                0.00316849277677302,-1.24298115132095,0.00901039339679783,1.43792861813732,1.35904704706377e-05,0.00498481688394449,-0.000362334066069950,0.999941841164624,0,
                0.00316849277677302,-1.24298115132095,0.00901039339679783,1.43792861813732,1.35904704706377e-05,0.00498481688394449,-0.000362334066069951,-5.81588353758243e-05,1;

    Eigen::Matrix<double, 9, 2> B_MPC_SCR;
    B_MPC_SCR <<-0.00825817977941648,0.00195715285454235,
                0.00611368638483995,-2.98545923103626e-06,
                0.154504030944002,2.04498401275607e-06,
                0.00711260976386360,3.46453179943276e-08,
                0,0.273850962926309,
                0.124576140827257,1.16441416594760e-06,
                0.196439188348341,1.30936811810626e-06,
                -0.0798296968153690,1.12126252533256e-06,
                0.000170303184630980,1.12126252533256e-06;

    Eigen::Matrix<double, 2, 9> C_MPC_SCR;
    C_MPC_SCR <<0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	1.0,
                1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0;

    Eigen::Matrix<double, 40, 10> CC; 
    CC <<1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 1.0, 0.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 1.0,	0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	1.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 1.0,
        -1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, -1.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	-1.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, -1.0, 0.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, -1.0,	0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, -1.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	-1.0, 0.0,
        0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, -1.0,
        1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 0.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 0.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 1.0, 0.0,	0.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 1.0,	0.0, 0.0,
        1.0, 0.0, 1.0, 0.0,	1.0, 0.0, 1.0, 0.0,	1.0, 0.0,
        0.0, 1.0, 0.0, 1.0,	0.0, 1.0, 0.0, 1.0,	0.0, 1.0,
        -1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	0.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, 0.0,	0.0, 0.0, 0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, 0.0, 0.0, 0.0,	0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, -1.0, 0.0, 0.0, 0.0,	0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0, 0.0,	0.0, 0.0,
        0.0, -1.0, 0.0, -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, 0.0,
        -1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0, 0.0,	-1.0, 0.0,
        0.0, -1.0, 0.0,	-1.0, 0.0, -1.0, 0.0, -1.0,	0.0, -1.0;            

    Eigen::Matrix<double, 10, 10> E;
    E <<93.2172750931091,-3.83826718311297,88.1681479549898,-3.77796096313441,83.2284586708218,-3.70200401130226,78.2604891653444,-3.61072108407428,73.2787013616333,-3.50459983301727,
        -3.83826718311297,1.96062914804818,-3.64060145651998,1.84638210902454,-3.44143216444384,1.74674389063012,-3.24152481000945,1.64694692022200,-3.04172338618247,1.54725736914064,
        88.1681479549898,-3.64060145651998,83.7688258331613,-3.58804771753063,79.0229385113656,-3.52048905117051,74.3905747250231,-3.43811095312905,69.7343432960223,-3.34129369606787,
        -3.77796096313441,1.84638210902454,-3.58804771753063,1.76908212905176,-3.39615632934568,1.66124453272153,-3.20293393985713,1.56805716690276,-3.00915436564203,1.47475397160263,
        83.2284586708218,-3.44143216444384,79.0229385113656,-3.39615632934568,74.9170964572697,-3.33666345079118,70.4686445436126,-3.26297050181687,66.1379879072894,-3.17531671308925,
        -3.70200401130226,1.74674389063012,-3.52048905117051,1.66124453272153,-3.33666345079118,1.59011276045681,-3.15103311033422,1.48848472742554,-2.96425374771667,1.40154983424492,
        78.2604891653444,-3.24152481000945,74.3905747250231,-3.20293393985713,70.4686445436126,-3.15103311033422,66.6502156777459,-3.08569328486460,62.4933059270656,-3.00698336621407,
        -3.61072108407428,1.64694692022200,-3.43811095312905,1.56805716690276,-3.26297050181687,1.48848472742554,-3.08569328486460,1.42332109971751,-2.90679401354373,1.32770402732583,
        73.2787013616333,-3.04172338618247,69.7343432960223,-3.00915436564203,66.1379879072894,-2.96425374771667,62.4933059270656,-2.90679401354373,58.9561093870899,-2.83669622508686,
        -3.50459983301727,1.54725736914064,-3.34129369606787,1.47475397160263,-3.17531671308925,1.40154983424492,-3.00698336621407,1.32770402732583,-2.83669622508686,1.26830966972427;

    Eigen::Matrix<double, 60, 10> H;
    H << 0.000170303184630980,1.12126252533256e-06,0,0,0,0,0,0,0,0,
        -0.00825817977941648,0.00195715285454235,0,0,0,0,0,0,0,0,
        0.00488926611661474,1.59498910666152e-05,0.000170303184630980,1.12126252533256e-06,0,0,0,0,0,0,
        -0.0272562890897740,0.00707724149396637,-0.00825817977941648,0.00195715285454235,0,0,0,0,0,0,
        0.0192116873423020,7.23170398900526e-05,0.00488926611661474,1.59498910666152e-05,0.000170303184630980,1.12126252533256e-06,0,0,0,0,
        -0.0520535861490272,0.0144586973634770,-0.0272562890897740,0.00707724149396637,-0.00825817977941648,0.00195715285454235,0,0,0,0,
        0.0459517927032407,0.000206077187254660,0.0192116873423020,7.23170398900526e-05,0.00488926611661474,1.59498910666152e-05,0.000170303184630980,1.12126252533256e-06,0,0,
        -0.0804877479444261,0.0234363399449217,-0.0520535861490272,0.0144586973634770,-0.0272562890897740,0.00707724149396637,-0.00825817977941648,0.00195715285454235,0,0,
        0.0857991670607256,0.000456306387091448,0.0459517927032407,0.000206077187254660,0.0192116873423020,7.23170398900526e-05,0.00488926611661474,1.59498910666152e-05,0.000170303184630980,1.12126252533256e-06,
        -0.111753495568434,0.0335194923024786,-0.0804877479444261,0.0234363399449217,-0.0520535861490272,0.0144586973634770,-0.0272562890897740,0.00707724149396637,-0.00825817977941648,0.00195715285454235,
        0.137882312992468,0.000862432542329752,0.0857991670607256,0.000456306387091448,0.0459517927032407,0.000206077187254660,0.0192116873423020,7.23170398900526e-05,0.00488926611661474,1.59498910666152e-05,
        -0.145562298181963,0.0443465731524125,-0.111753495568434,0.0335194923024786,-0.0804877479444261,0.0234363399449217,-0.0520535861490272,0.0144586973634770,-0.0272562890897740,0.00707724149396637,
        0.200404498072690,0.00146227905872934,0.137882312992468,0.000862432542329752,0.0857991670607256,0.000456306387091448,0.0459517927032407,0.000206077187254660,0.0192116873423020,7.23170398900526e-05,
        -0.181716593024577,0.0556515620035428,-0.145562298181963,0.0443465731524125,-0.111753495568434,0.0335194923024786,-0.0804877479444261,0.0234363399449217,-0.0520535861490272,0.0144586973634770,
        0.271177289198660,0.00229058714053501,0.200404498072690,0.00146227905872934,0.137882312992468,0.000862432542329752,0.0857991670607256,0.000456306387091448,0.0459517927032407,0.000206077187254660,
        -0.219942956866304,0.0672391838985862,-0.181716593024577,0.0556515620035428,-0.145562298181963,0.0443465731524125,-0.111753495568434,0.0335194923024786,-0.0804877479444261,0.0234363399449217,
        0.347996916226176,0.00337788544589556,0.271177289198660,0.00229058714053501,0.200404498072690,0.00146227905872934,0.137882312992468,0.000862432542329752,0.0857991670607256,0.000456306387091448,
        -0.259865514647052,0.0789665591079404,-0.219942956866304,0.0672391838985862,-0.181716593024577,0.0556515620035428,-0.145562298181963,0.0443465731524125,-0.111753495568434,0.0335194923024786,
        0.428870581257645,0.00474969525746121,0.347996916226176,0.00337788544589556,0.271177289198660,0.00229058714053501,0.200404498072690,0.00146227905872934,0.137882312992468,0.000862432542329752,
        -0.301040832757305,0.0907296561222684,-0.259865514647052,0.0789665591079404,-0.219942956866304,0.0672391838985862,-0.181716593024577,0.0556515620035428,-0.145562298181963,0.0443465731524125,
        0.512125149044569,0.00642607941335377,0.428870581257645,0.00474969525746121,0.347996916226176,0.00337788544589556,0.271177289198660,0.00229058714053501,0.200404498072690,0.00146227905872934,
        -0.343008541008013,0.102453303624386,-0.301040832757305,0.0907296561222684,-0.259865514647052,0.0789665591079404,-0.219942956866304,0.0672391838985862,-0.181716593024577,0.0556515620035428,
        0.596435416580957,0.00842152230904545,0.512125149044569,0.00642607941335377,0.428870581257645,0.00474969525746121,0.347996916226176,0.00337788544589556,0.271177289198660,0.00229058714053501,
        -0.385335224140593,0.114083826143141,-0.343008541008013,0.102453303624386,-0.301040832757305,0.0907296561222684,-0.259865514647052,0.0789665591079404,-0.219942956866304,0.0672391838985862,
        0.680804192097711,0.0107450998081287,0.596435416580957,0.00842152230904545,0.512125149044569,0.00642607941335377,0.428870581257645,0.00474969525746121,0.347996916226176,0.00337788544589556,
        -0.427643582861041,0.125583603632002,-0.385335224140593,0.114083826143141,-0.343008541008013,0.102453303624386,-0.301040832757305,0.0907296561222684,-0.259865514647052,0.0789665591079404,
        0.764518198048374,0.0134008772669955,0.680804192097711,0.0107450998081287,0.596435416580957,0.00842152230904545,0.512125149044569,0.00642607941335377,0.428870581257645,0.00474969525746121,
        -0.469626655317979,0.136927036286943,-0.427643582861041,0.125583603632002,-0.385335224140593,0.114083826143141,-0.343008541008013,0.102453303624386,-0.301040832757305,0.0907296561222684,
        0.847095734694521,0.0163884653522350,0.764518198048374,0.0134008772669955,0.680804192097711,0.0107450998081287,0.596435416580957,0.00842152230904545,0.512125149044569,0.00642607941335377,
        -0.511050278054464,0.148097534313048,-0.469626655317979,0.136927036286943,-0.427643582861041,0.125583603632002,-0.385335224140593,0.114083826143141,-0.343008541008013,0.102453303624386,
        0.928235520633323,0.0197036655054596,0.847095734694521,0.0163884653522350,0.764518198048374,0.0134008772669955,0.680804192097711,0.0107450998081287,0.596435416580957,0.00842152230904545,
        -0.551747793655211,0.159085256655750,-0.511050278054464,0.148097534313048,-0.469626655317979,0.136927036286943,-0.427643582861041,0.125583603632002,-0.385335224140593,0.114083826143141,
        1.00777147905216,0.0233391462713481,0.928235520633323,0.0197036655054596,0.847095734694521,0.0163884653522350,0.764518198048374,0.0134008772669955,0.680804192097711,0.0107450998081287,
        -0.591610573568001,0.169885399957988,-0.551747793655211,0.159085256655750,-0.511050278054464,0.148097534313048,-0.469626655317979,0.136927036286943,-0.427643582861041,0.125583603632002,
        1.08563525028025,0.0272851046099510,1.00777147905216,0.0233391462713481,0.928235520633323,0.0197036655054596,0.847095734694521,0.0163884653522350,0.764518198048374,0.0134008772669955,
        -0.630577021104591,0.180496895188734,-0.591610573568001,0.169885399957988,-0.551747793655211,0.159085256655750,-0.511050278054464,0.148097534313048,-0.469626655317979,0.136927036286943,
        1.16182648539043,0.0315298798914171,1.08563525028025,0.0272851046099510,1.00777147905216,0.0233391462713481,0.928235520633323,0.0197036655054596,0.847095734694521,0.0163884653522350,
        -0.668621786708224,0.190921409596257,-0.630577021104591,0.180496895188734,-0.591610573568001,0.169885399957988,-0.551747793655211,0.159085256655750,-0.511050278054464,0.148097534313048,
        1.23639011195591,0.0360605006494037,1.16182648539043,0.0315298798914171,1.08563525028025,0.0272851046099510,1.00777147905216,0.0233391462713481,0.928235520633323,0.0197036655054596,
        -0.705746158994151,0.201162580050436,-0.668621786708224,0.190921409596257,-0.630577021104591,0.180496895188734,-0.591610573568001,0.169885399957988,-0.551747793655211,0.159085256655750,
        1.30939943447859,0.0408631543758124,1.23639011195591,0.0360605006494037,1.16182648539043,0.0315298798914171,1.08563525028025,0.0272851046099510,1.00777147905216,0.0233391462713481,
        -0.741970043825980,0.211225423760061,-0.705746158994151,0.201162580050436,-0.668621786708224,0.190921409596257,-0.630577021104591,0.180496895188734,-0.591610573568001,0.169885399957988,
        1.38094390267992,0.0459235783687392,1.30939943447859,0.0408631543758124,1.23639011195591,0.0360605006494037,1.16182648539043,0.0315298798914171,1.08563525028025,0.0272851046099510,
        -0.777325592234582,0.221115886302126,-0.741970043825980,0.211225423760061,-0.705746158994151,0.201162580050436,-0.668621786708224,0.190921409596257,-0.630577021104591,0.180496895188734,
        1.45112049667669,0.0512273750174883,1.38094390267992,0.0459235783687392,1.30939943447859,0.0408631543758124,1.23639011195591,0.0360605006494037,1.16182648539043,0.0315298798914171,
        -0.811852341727251,0.230840496729984,-0.777325592234582,0.221115886302126,-0.741970043825980,0.211225423760061,-0.705746158994151,0.201162580050436,-0.668621786708224,0.190921409596257,
        1.52002784728803,0.0567602582684230,1.45112049667669,0.0512273750174883,1.38094390267992,0.0459235783687392,1.30939943447859,0.0408631543758124,1.23639011195591,0.0360605006494037,
        -0.845593646552065,0.240406106548838,-0.811852341727251,0.230840496729984,-0.777325592234582,0.221115886302126,-0.741970043825980,0.211225423760061,-0.705746158994151,0.201162580050436,
        1.58776238322251,0.0625082397916254,1.52002784728803,0.0567602582684230,1.45112049667669,0.0512273750174883,1.38094390267992,0.0459235783687392,1.30939943447859,0.0408631543758124,
        -0.878594150266387,0.249819694465488,-0.845593646552065,0.240406106548838,-0.811852341727251,0.230840496729984,-0.777325592234582,0.221115886302126,-0.741970043825980,0.211225423760061,
        1.65441595213389,0.0684577639833732,1.58776238322251,0.0625082397916254,1.52002784728803,0.0567602582684230,1.45112049667669,0.0512273750174883,1.38094390267992,0.0459235783687392,
        -0.910898068600586,0.259088222642220,-0.878594150266387,0.249819694465488,-0.845593646552065,0.240406106548838,-0.811852341727251,0.230840496729984,-0.777325592234582,0.221115886302126,
        1.72007449201802,0.0745958007629078,1.65441595213389,0.0684577639833732,1.58776238322251,0.0625082397916254,1.52002784728803,0.0567602582684230,1.45112049667669,0.0512273750174883,
        -0.942548082188362,0.268218533112761,-0.910898068600586,0.259088222642220,-0.878594150266387,0.249819694465488,-0.845593646552065,0.240406106548838,-0.811852341727251,0.230840496729984,
        1.78481743322402,0.0809099044518661,1.72007449201802,0.0745958007629078,1.65441595213389,0.0684577639833732,1.58776238322251,0.0625082397916254,1.52002784728803,0.0567602582684230,
        -0.973584675219137,0.277217275311691,-0.942548082188362,0.268218533112761,-0.910898068600586,0.259088222642220,-0.878594150266387,0.249819694465488,-0.845593646552065,0.240406106548838,
        1.84871759270566,0.0873882460863314,1.78481743322402,0.0809099044518661,1.72007449201802,0.0745958007629078,1.65441595213389,0.0684577639833732,1.58776238322251,0.0625082397916254,
        -1.00404579097088,0.286090857497108,-0.973584675219137,0.277217275311691,-0.942548082188362,0.268218533112761,-0.910898068600586,0.259088222642220,-0.878594150266387,0.249819694465488,
        1.91184138509045,0.0940196254652210,1.84871759270566,0.0873882460863314,1.78481743322402,0.0809099044518661,1.72007449201802,0.0745958007629078,1.65441595213389,0.0684577639833732,
        -1.03396670557101,0.294845416321143,-1.00404579097088,0.286090857497108,-0.973584675219137,0.277217275311691,-0.942548082188362,0.268218533112761,-0.910898068600586,0.259088222642220;   

    Eigen::Matrix<double, 60, 11> P; 
    P <<0.00316849277677302,-1.24298115132095,0.00901039339679783,1.43792861813732,1.35904704706377e-05,0.00498481688394449,-0.000362334066069951,-5.81588353758243e-05,1,1,0,
        0.994117296583461,0.802927731928133,-0.0504299106818950,-0.633605552139330,0.0116011629669788,-0.000787174317024567,-0.0156756950743316,0.00277792390596143,0,0,1,
        0.0147862190232486,-3.44658887669594,0.0415646380501487,4.23034877700215,0.000107602878035793,0.0187357823075173,0.00465112021568694,-0.00170150537601606,2,1,0,
        1.97874763526351,2.28137835729021,-0.106123934448045,-1.70354709948715,0.0315353553504808,-0.00354470861144221,-0.0585482859635548,0.0118524712103036,0,0,1,
        0.0390454877697811,-6.44202130759481,0.101879837376052,8.19854275982282,0.000384795388283680,0.0400542766935764,0.0269119329686768,-0.00810821404006589,3,1,0,
        2.95104681554373,4.27045736194174,-0.153643929961144,-3.09851828205308,0.0573919867374325,-0.00794130822116417,-0.126687438486096,0.0289954381751500,0,0,1,
        0.0794518690498886,-10.1139007130420,0.185037718125978,13.1097495715804,0.000964098245720601,0.0659919530615806,0.0790134771630388,-0.0233124241336119,4,1,0,
        3.90895075331321,6.62331137379456,-0.191752431713049,-4.74377145964557,0.0873923924897411,-0.0133920831721091,-0.215153841478775,0.0552081191571822,0,0,1,
        0.138985657497630,-14.3626239839088,0.281352141565355,18.7159634671716,0.00196936226554662,0.0934015203930759,0.170449900686194,-0.0514697626304073,5,1,0,
        4.85104007851524,9.22514516130585,-0.222580275235939,-6.57733010541429,0.120225089170917,-0.0193257147788540,-0.319609411913096,0.0911958016528543,0,0,1,
        0.220131449215081,-19.0870170420155,0.380276741488048,24.7824437654997,0.00352216261748986,0.119647400775562,0.305971673996738,-0.0963315371042605,6,1,0,
        5.77638503336579,11.9903955578627,-0.248194164753739,-8.54121926132202,0.154924371503153,-0.0252272796139330,-0.436985027631065,0.137548380650037,0,0,1,
        0.324859215300626,-24.1805716838946,0.472855806396477,31.1047514127112,0.00573655627088771,0.142859684245597,0.485599510589242,-0.160946030222325,7,1,0,
        6.68441932255757,14.8552069649815,-0.269698615899089,-10.5802319705545,0.190780507369770,-0.0306562219454600,-0.565128436602057,0.194773725206929,0,0,1,
        0.454606702085504,-29.5347697286697,0.552799274771606,37.5161991936491,0.00871502997536940,0.161938770508165,0.705570339611433,-0.247546451233777,8,1,0,
        7.57485102424874,17.7703912254328,-0.287358817312001,-12.6435932548029,0.227273288263862,-0.0352674641354087,-0.702292718602833,0.263274400295284,0,0,1,
        0.610285377213641,-35.0448088824058,0.616598007377417,43.8885463596470,0.0125454864181456,0.176436589914320,0.959620446519040,-0.357567869544076,9,1,0,
        8.44760321730510,20.6964652397685,-0.300999995117448,-14.6870281954810,0.264022932689087,-0.0388268808651789,-0.846775962858762,0.343316174402937,0,0,1,
        0.792314091229026,-40.6149768608859,0.663106902423560,50.1286201858147,0.0172992966239998,0.186392546055875,1.24022423426156,-0.491739416194747,10,1,0,
        9.30277379414504,23.6007372535728,-0.310365662952331,-16.6741525838425,0.300753871294981,-0.0412136621999247,-0.996764044016440,0.435009087615793,0,0,1,
        1.00067510029797,-46.1624241573090,0.692919820714105,56.1729585462122,0.0230304220229398,0.192169953228676,1.53959601581519,-0.650210355887357,11,1,0,
        10.1406057629006,26.4558558735482,-0.315338425309706,-18.5769194672639,0.337268053151076,-0.0424092320812926,-1.15032793450924,0.538305988897064,0,0,1,
        1.23498361083479,-51.6190564740544,0.707739387743890,61.9819018567729,0.0297755204670068,0.194316313459395,1.85039492529112,-0.832682203787489,12,1,0,
        10.9614624616949,29.2391911993605,-0.316028074550276,-20.3752517884718,0.373425250641121,-0.0424768785681553,-1.30550546895255,0.653015808820269,0,0,1,
        1.49456210635898,-56.9317882031205,0.709845571087256,67.5339896774451,0.0375548693005836,0.193456048846427,2.16615081042174,-1.03853060028023,13,1,0,
        11.7658048624614,31.9325694717214,-0.312766951536836,-22.0561304859065,0.409128483988069,-0.0415374354926038,-1.46040931002239,0.778826234985355,0,0,1,
        1.77851252457776,-62.0616043782560,0.701699206733571,72.8210922346591,0.0463738927475697,0.190215548610267,2.48146510049143,-1.26690913301437,14,1,0,
        12.5541700181621,34.5220700337679,-0.306055530143953,-23.6124086864046,0.444313180537937,-0.0397455144732845,-1.61332397054472,0.915330534179966,0,0,1,
        2.08578165247723,-66.9818967999406,0.685677129161126,77.8444261210459,0.0562250725167962,0.185175951518155,2.79204993627651,-1.51683283885998,15,1,0,
        13.3271507316079,36.9977474910696,-0.296491384057990,-25.0415645145355,0.478939059177717,-0.0372691881825952,-1.76277405115788,1.06205447274373,0,0,1,
        2.41521723006228,-71.6764656176705,0.663916766335561,82.6114379313170,0.0670900405569143,0.178847483924267,3.09466344650749,-1.78724232989896,16,1,0,
        14.0853769202921,39.3532442878791,-0.284702273370376,-26.3445329312114,0.512984010568209,-0.0342744606241543,-1.90755957080003,1.21848073773673,0,0,1,
        2.76561391185878,-76.1374721121108,0.638242455652188,87.1334559956954,0.0789416894293351,0.171659232596666,3.38698738867266,-2.07705105719871,17,1,0,
        14.8294991672279,41.5853144679958,-0.271293552026421,-27.5246931665955,0.546439449471544,-0.0309146806210673,-2.04676222928529,1.38406952616289,0,0,1,
        3.13574937289815,-80.3635261512850,0.610147362009263,91.4239791698646,0.0917461783825917,0.163959108088612,3.66748053272491,-2.38517875359273,18,1,0,
        15.5601747811842,43.6933011566902,-0.256812795059928,-28.5870407633046,0.579306763654293,-0.0273243318077948,-2.17972992287311,1.55827489739606,0,0,1,
        3.52441152438430,-84.3580083435271,0.580809671434193,95.4974705332436,0.105464754486148,0.156019909489708,3.93522976545286,-2.71057403258958,19,1,0,
        16.2780564727780,45.6786115494829,-0.241730298321634,-29.5375423623701,0.611594589120334,-0.0236162965866272,-2.30604740014358,1.74055707448507,0,0,1,
        3.93041813011486,-88.1276663509032,0.551127257772593,99.3685376964651,0.120055343776398,0.148048530016256,4.18981193023097,-3.05222876929915,20,1,0,
        16.9837835588167,47.5442243228999,-0.226432164030647,-30.3826541384186,0.643316715441076,-0.0198816265932379,-2.42549993267788,1.93039119735842,0,0,1,
        4.35263019752801,-91.6814852465991,0.521760024572597,103.051400888659,0.135473895416670,0.140196301498550,4.43117297362478,-3.40918643765761,21,1,0,
        17.6779754670377,49.2942522910237,-0.211222233662722,-31.1289773241543,0.674490476752879,-0.0161909464243789,-2.53803523093484,2.12727315525866,0,0,1,
        4.78996044979147,-95.0298088613944,0.493173117341180,106.559569904833,0.151675482204676,0.132569220325766,4.65952669213189,-3.78054612906232,22,1,0,
        18.3612272318801,50.9335717186315,-0.196329491939588,-31.7830230036195,0.705135520339571,-0.0125967843726888,-2.64372713831528,2.33072312909347,0,0,1,
        5.24137803751414,-98.1836780489552,0.465677119618051,109.905668859560,0.168615174191170,0.125237337590735,4.87527276186027,-4.16546357927505,23,1,0,
        19.0341066406632,52.4675207163472,-0.181918271617766,-32.3510605533598,0.735272870483471,-0.00913630659563652,-2.74274317971830,2.54028741200074,0,0,1,
        5.70591046834417,-101.154348593770,0.439463330775152,113.101362624823,0.186248709970391,0.118242965560589,5.07893230856424,-4.56315019958925,24,1,0,
        19.6971526951537,53.9016630007576,-0.168099352443523,-32.8390278814548,0.764924223853686,-0.00583409731281561,-2.83531693060489,2.75553898595775,0,0,1,
        6.18264354989500,-103.952952921295,0.414633483230927,116.157350780251,0.204532993729735,0.111607590728231,5.27109863540167,-4.97287084438727,25,1,0,
        20.3508750825205,55.2416097135366,-0.154940721680794,-33.2524857858405,0.794111426416963,-0.00270476301307052,-2.92172540594805,2.97607723681693,0,0,1,
        6.67071997290377,-106.590273618310,0.391223997150621,119.083404206289,0.223426446656591,0.105337527064293,5.45240057078369,-5.39394084241085,26,1,0,
        20.9957543909602,56.4928903854497,-0.142477291638468,-33.5966026822274,0.822856092238715,0.000244759712819974,-3.00227119116500,3.20152710218622,0,0,1,
        7.16933701514480,-109.076601583668,0.369225262153680,121.888426558541,0.242889239841654,0.0994284214916650,5.62347601913260,-5.82572266311927,27,1,0,
        21.6322428506393,57.6608638934046,-0.130719247536119,-33.8761593442316,0.851179332592683,0.00301324208680619,-3.07726877893682,3.43153787155381,0,0,1,
        7.67774372468640,-111.421656538261,0.348596606124148,124.580528219828,0.262883433205381,0.0938687595574228,5.78495355571967,-6.26762247249988,28,1,0,
        22.2607654247061,58.7506608646054,-0.119658947960599,-34.0955660698801,0.879101570167751,0.00560355008797227,-3.14703446984589,3.66578179727428,0,0,1,
        8.19523784269890,-113.634552160704,0.329277650404416,127.167104319941,0.283373041804757,0.0886425288484727,5.93744021803054,-6.71908674606493,29,1,0,
        22.8817211148991,59.7671500299072,-0.109276449555910,-34.2588868673337,0.906642418274713,0.00802135638567235,-3.21187918598405,3.90395262757121,0,0,1,
        8.72116264870747,-115.723792070536,0.311196717418728,129.654911354130,0.304324047563373,0.0837311918513702,6.08151396112256,-7.17959904353875,30,1,0,
        23.4954843803198,60.7149222412911,-0.0995438061769011,-34.3698669165551,0.933820609097790,0.0102741391495269,-3.27210359397568,4.14576413669914,0,0,1;

    Eigen::Matrix<double, 60, 2> Rs;
    Rs <<1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0,
        1.0, 0.0,
        0.0, 1.0;   

    Eigen::Matrix<double, 40, 1> dd;
    dd <<1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        1.20000000000000,
        12,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        33.6706000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000,
        2,
        6.32940000000000;   
        
    Eigen::Matrix<double, 40, 2> dupast;
    dupast <<0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            0.0, 0.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            -1.0, 0.0,
            0.0, -1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0,
            1.0, 0.0,
            0.0, 1.0;     

    Eigen::Matrix<double, 9, 1> x_prev;
    Eigen::Matrix<double, 60, 1> ref;
    Eigen::Matrix<double, 9, 1> x;
    Eigen::Matrix<double, 2, 1> y;
    Eigen::Matrix<double, 2, 1> u;
    Eigen::Matrix<double, 11, 1> Xf;
    Eigen::Matrix<double, 10, 1> F;
    Eigen::Matrix<double, 40, 1> d;
    Eigen::Matrix<double, 10, 1> DeltaU;
    x <<0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0;
    u <<0.0,
        0.0;
    bool MPC_Activate=false;     

    int MPC_P=30;//choose
	float MPC_Ts=0.08;//choose (Setup)
    float gamma=(float)(4*M_PI/180);//From PX4       

    //publish a few values before starting to allow changing into offboard mode
    // for(int i = 100; ros::ok() && i > 0; --i){
    //     // Required for now to allow vehicle to go into offboard mode(CHECK if you can make mpc outputs publish do the same)
    //     local_pos_pub.publish(pose);

    //     //Run callback functions
    //     ros::spinOnce();
    //     //Loop back after 0.02 seconds is over
    //     rate.sleep();
    // }

    // mavros_msgs::SetMode offb_set_mode;
    // offb_set_mode.request.custom_mode = "OFFBOARD";

    // mavros_msgs::CommandBool arm_cmd;
    // arm_cmd.request.value = true;

    ros::Time last_request = ros::Time::now();

    while(ros::ok()){
        // if( current_state.mode != "OFFBOARD" &&
        //     (ros::Time::now() - last_request > ros::Duration(5.0))){
        //     if( set_mode_client.call(offb_set_mode) &&
        //         offb_set_mode.response.mode_sent){
        //         ROS_INFO("Offboard enabled");
        //     }
        //     last_request = ros::Time::now();
        // } else {
        //     if( !current_state.armed &&
        //         (ros::Time::now() - last_request > ros::Duration(5.0))){
        //         if( arming_client.call(arm_cmd) &&
        //             arm_cmd.response.success){
        //             ROS_INFO("Vehicle armed");
        //         }
        //         last_request = ros::Time::now();
        //     }
        // }

        // if( current_state.mode != "OFFBOARD" &&
        //     (ros::Time::now() - last_request > ros::Duration(5.0))){
        //     if( set_mode_client.call(offb_set_mode) &&
        //         offb_set_mode.response.mode_sent){
        //         ROS_INFO("Offboard enabled");
        //     }
        //     last_request = ros::Time::now();
        // }

        // Required for now to allow vehicle to go into offbaord mode(CHECK if you can make mpc outputs publish do the same)
        local_pos_pub.publish(pose);

        if(current_state.mode == "OFFBOARD"){
        //MPC reset condition
        // if(MPC_Activate && mpc_ins.state==0){
        if(MPC_Activate && !mpc_ins.mpc_activate){
            std::cout<<"Reset MPC\n";
            MPC_Activate=false;
            // x(0)=0.0;x(1)=0.0;x(2)=0.0;x(3)=0.0;x(4)=0.0;x(5)=0.0;x(6)=0.0;x(7)=0.0;x(8)=0.0;
            // u(0)=0.0;u(1)=0.0;
            x.setZero(9,1);
            u.setZero(2,1);
            // std::cout<<"x : "<<x<<"\n";
        }

        // if(mpc_ins.state>=1){ //Activate when SM is at state 1 or above 
           if(mpc_ins.mpc_activate){ //Activate MPC when controllers run it
            // Run MPC 
            MPC_Activate=true;       
            //Set inputs to MPC

            // for(int i=0;i<60;i++){
            //     MPC_ref[i]=mpc_ins.mpc_ref_in[i];
            //     ref(i)=(double)MPC_ref[i];
            // }

            MPC_ref[0]=mpc_ins.mpc_ref_in[0];
            MPC_ref[1]=mpc_ins.mpc_ref_in[1];
            
            // MPC referance generator
            for(int i=0;i<MPC_P;i++){
		        // if(mpc_ins.state>=2){ //Activate when SM is at state 2 or above
			    if(mpc_ins.ramp_trajectory && MPC_ref[0]>15){ //Activate ramp trajectory when commanded and above 15m
                    ref(i*2)=MPC_ref[0]+(i)*tan(-gamma)*MPC_Ts*mpc_ins.grd_vel;
			        ref(i*2+1)=MPC_ref[1];
		        }else{
			        ref(i*2)=MPC_ref[0];
			        ref(i*2+1)=MPC_ref[1];
		        }
	        }

            MPC_mo[0]=mpc_ins.mpc_mo_in[0];MPC_mo[1]=mpc_ins.mpc_mo_in[1];
            
            // std::cout<<"MPC_in ref: "<<ref(0)<<" ; "<<ref(1)<<"\n";
            // std::cout<<"MPC_in mo: "<<MPC_mo[0]<<" ; "<<MPC_mo[1]<<"\n";

            Eigen::Matrix<double, 9, 1> x_prev;
            x_prev <<(double)MPC_mo[1],
                    x(1),
                    x(2),
                    x(3),
                    x(4),
                    x(5),
                    x(6),
                    x(7),
                    (double)MPC_mo[0];

            // TESTING
            // std::cout<<"MPC_in ref: "<<mpc_ins.mpc_ref_in[0]<<" ; "<<mpc_ins.mpc_ref_in[37]<<"\n";
            // std::cout<<"MPC_in mo: "<<mpc_ins.mpc_mo_in[0]<<" ; "<<mpc_ins.mpc_mo_in[1]<<"\n";

            // Model predictions
            x = A_MPC_SCR*x_prev + B_MPC_SCR*u;
            y = C_MPC_SCR*x;

            Eigen::Matrix<double, 9, 1> deltax=x-x_prev;
            Eigen::Matrix<double, 11, 1> Xf;
            Xf <<deltax(0),
                deltax(1),
                deltax(2),
                deltax(3),
                deltax(4),
                deltax(5),
                deltax(6),
                deltax(7),
                deltax(8),
                y(0),
                y(1);

            F=-2*H.transpose()*(ref-P*Xf);

            d = dd + dupast*u;

            DeltaU=QPhild(E, F, CC, d);

            Eigen::Matrix<double, 5, 2> DeltaU_1;
            DeltaU_1 <<DeltaU(0,0), DeltaU(1,0),
                       DeltaU(2,0), DeltaU(3,0),
                       DeltaU(4,0), DeltaU(5,0),
                       DeltaU(6,0), DeltaU(7,0),
                       DeltaU(8,0), DeltaU(9,0);

            Eigen::Matrix<double, 1, 2> deltau= DeltaU_1.row(0);

            u = u + deltau.transpose();            

            mpc_outs.mpc_mv_out[0]=(float)u(0);
            mpc_outs.mpc_mv_out[1]=(float)u(1);
            //!!!ADD publish to topic!!!
            mpc_outputs_pub.publish(mpc_outs);
        }
        //!!!TESTING!!!
        // std::cout<< "MPC_mv : " << MPC_mv[0] <<" ; " << MPC_mv[1]<<"\n";
        // std_msgs::String msg_out;
        // std::stringstream ss;
        // ss << "MPC_mv : " << MPC_mv[0] <<" ; " << MPC_mv[1];
        // msg_out.data = ss.str();
        // ROS_INFO("%s", msg_out.data.c_str());
        }

        ros::spinOnce();
        rate.sleep();
    }
    //Teminate MPC
    // MPC0_terminate();

    return 0;
}

